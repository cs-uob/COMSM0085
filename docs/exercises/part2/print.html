<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Exercises</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="overview.html">Overview</a></li><li class="chapter-item expanded affix "><li class="part-title">Week 6: The Web</li><li class="chapter-item expanded "><a href="http/index.html"><strong aria-hidden="true">1.</strong> HTTP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="http/setup.html"><strong aria-hidden="true">1.1.</strong> Setup</a></li><li class="chapter-item expanded "><a href="http/explore.html"><strong aria-hidden="true">1.2.</strong> Exploring HTTP</a></li><li class="chapter-item expanded "><a href="http/research.html"><strong aria-hidden="true">1.3.</strong> Online research</a></li><li class="chapter-item expanded "><a href="http/server.html"><strong aria-hidden="true">1.4.</strong> A server in Java</a></li></ol></li><li class="chapter-item expanded "><a href="html5/index.html"><strong aria-hidden="true">2.</strong> HTML5</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="html5/basic.html"><strong aria-hidden="true">2.1.</strong> Basic HTML5</a></li><li class="chapter-item expanded "><a href="html5/templates.html"><strong aria-hidden="true">2.2.</strong> Templates</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Week 7: CSS</li><li class="chapter-item expanded "><a href="css/index.html"><strong aria-hidden="true">3.</strong> CSS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="css/text.html"><strong aria-hidden="true">3.1.</strong> Styling Text</a></li><li class="chapter-item expanded "><a href="css/framework.html"><strong aria-hidden="true">3.2.</strong> Frameworks</a></li></ol></li><li class="chapter-item expanded "><a href="cssgrid/index.html"><strong aria-hidden="true">4.</strong> CSS grids</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="cssgrid/intro.html"><strong aria-hidden="true">4.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="cssgrid/curriculum.html"><strong aria-hidden="true">4.2.</strong> Curriculum exercise</a></li><li class="chapter-item expanded "><a href="cssgrid/trees.html"><strong aria-hidden="true">4.3.</strong> Trees exercise (responsive layout)</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Week 8: Javascript</li><li class="chapter-item expanded "><a href="js/index.html"><strong aria-hidden="true">5.</strong> JavaScript</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="js/MyCoolApp.html"><strong aria-hidden="true">5.1.</strong> My Cool App</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Week 9: Web Scraping</li><li class="chapter-item expanded "><a href="scrape/index.html"><strong aria-hidden="true">6.</strong> Web scraping</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="scrape/crawl.html"><strong aria-hidden="true">6.1.</strong> Crawling</a></li><li class="chapter-item expanded "><a href="scrape/soup.html"><strong aria-hidden="true">6.2.</strong> BeautifulSoup</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Week 10: Practical Encryption</li><li class="chapter-item expanded "><a href="encryption/index.html"><strong aria-hidden="true">7.</strong> Practical Encryption</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="encryption/openssl.html"><strong aria-hidden="true">7.1.</strong> OpenSSL</a></li><li class="chapter-item expanded "><a href="encryption/pgp.html"><strong aria-hidden="true">7.2.</strong> PGP</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Exercises</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p>This page contains the exercises for Part 2 (the last 5 weeks) of COMSM0085 Software Tools.
As with Part 1, each week usually contains two workbooks -- sets of exercises which are supported
by videos to watch, or by set reading materials (more prominent in this part of
the unit). The exercises will require you to do some work within your Linux
VM in Vagrant, which we'll be supporting in the labs, but which you should
attempt before the lab to get the most out of the unit.</p>
<p>Part 2 focuses on web technologies. The Web is one of the largest software
ecosystems ever built, and a lot of programmers will either work on web
technologies or make use of them to present their other work. We'll be covering
the basics: how to write webpages, style them using CSS, make them interactive
using Javascript. Then we'll look at ways to treat websites and webpages as
parseable resources, and conclude by looking at the kinds of encryption needed
in common web transactions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http"><a class="header" href="#http">HTTP</a></h1>
<p>HTTP, or HyperText Transfer Protocol, is one of the basic protocols that make up the internet - and usually the lowest level that a web developer needs to concern themselves with frequently.</p>
<h2 id="videos"><a class="header" href="#videos">Videos</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Video</th><th style="text-align: right">Length</th><th>Slides</th></tr></thead><tbody>
<tr><td><a href="https://web.microsoftstream.com/video/99c10922-d2fa-4a82-8098-4f779ea026e8">HTTP</a></td><td style="text-align: right">26 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EaKDKCP6APNJj9c6PH35ZLUBz97c5mVLITbUBxiYm-UfSw?e=D4Zwao">slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/43097d0a-1064-42d0-8a3a-dd67bc78542c">The Internet</a></td><td style="text-align: right">15 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EW193TDO4qVHtgZONmbmNXYB1ypxNTN3DIOrlS2n7aEkPg?e=MuI7jC">slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/4ed9cab8-021d-41b1-bffb-4fdf5fa11fe4">URLs</a></td><td style="text-align: right">7 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EUY5-p9SDSJFnqDPlBRzUxwBuhV9uORYmF7ZLoOhgAySbA?e=LAaGZv">slides</a></td></tr>
</tbody></table>
</div>
<h2 id="reading"><a class="header" href="#reading">Reading</a></h2>
<ul>
<li><a href="https://www.rfc-editor.org/rfc/rfc7230">RFC 7230</a> - this is a comprehensive
outline of the protocol for HTTP, but you can focus on sections 2.1, 2.2, 2.7 and 3.</li>
</ul>
<h2 id="exercises"><a class="header" href="#exercises">Exercises</a></h2>
<ul>
<li><a href="http/./setup.html">Setup</a></li>
<li><a href="http/./explore.html">Exploring HTTP</a></li>
<li><a href="http/./research.html">Online research</a></li>
<li><a href="http/./server.html">A server in Java</a></li>
</ul>
<h2 id="optional"><a class="header" href="#optional">Optional</a></h2>
<p>You can read the RFC for the internet protocol IP at <a href="https://www.rfc-editor.org/rfc/rfc791.html">RFC 791</a>.</p>
<p>You can read the RFC for the transmission control protocol at <a href="https://www.rfc-editor.org/rfc/rfc793">RFC 793</a>.</p>
<p>You can read the RFC for URIs at <a href="https://www.rfc-editor.org/rfc/rfc3986">RFC 3986</a>.</p>
<p>If you want to, you can read further about HTTP (including the new HTTP/2 standard) on the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP">Mozilla Developer Network</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="set-up"><a class="header" href="#set-up">Set-up</a></h1>
<p>From this point on we will be running web servers on our development environment, and connecting to them with web browsers. To get this to work we need to set some things up first, so please follow the instructions for your environment:</p>
<h2 id="lab-machine-native"><a class="header" href="#lab-machine-native">Lab machine, native</a></h2>
<p>These instructions apply if you are working directly on a lab machine (not using a Vagrant VM).</p>
<p>You do not need to set up anything special. As you are not root, you can only serve from TCP ports 1024 or above, but that is not a problem - we will use port 8000 by default.</p>
<p>Proceed directly to <a href="http/explore.html">exploring HTTP</a>.</p>
<h2 id="lab-machine-with-vagrant"><a class="header" href="#lab-machine-with-vagrant">Lab machine, with Vagrant</a></h2>
<p>If you want to run a server inside a Vagrant VM and connect to it with a browser directly on the lab machine (outside the VM), then you will need to tell Vagrant which ports within the VM to make available outside the VM. Open your Vagrantfile and add the line</p>
<pre><code>config.vm.network "forwarded_port", guest: 8000, host: 8000
</code></pre>
<p>in the main block (just before the <code>config.vm.provision</code> line will do), then restart your VM if it is already running. This tells Vagrant to open a server on port 8000 on the host (the lab machine), and forward any traffic it receives to port 8000 on the VM.</p>
<p>You can now start the VM, run a server inside the VM, and connect to it from the browser on the lab machine.</p>
<p>Proceed to <a href="http/explore.html">exploring HTTP</a> and run the server (the <code>nc</code> command) inside the VM, but use the browser on the lab machine directly. Note that the <code>http-response</code> file mentioned on that page needs to go in the correct folder inside the VM, where you started the server.</p>
<h2 id="your-own-machine-without-vagrant"><a class="header" href="#your-own-machine-without-vagrant">Your own machine, without Vagrant</a></h2>
<p>If you have a system that supports the <code>nc</code> and <code>wget</code> commands (Mac OS, Linux or WSL should all offer the option to install them) then you can proceed directly to <a href="http/explore.html">exploring HTTP</a>.</p>
<p>You might get one or more firewall warning pop-ups, which you will have to "allow".</p>
<h2 id="your-own-machine-with-vagrant"><a class="header" href="#your-own-machine-with-vagrant">Your own machine, with Vagrant</a></h2>
<p>Configure vagrant as in the section "Lab machine, with Vagrant" above, that is add the line</p>
<pre><code>config.vm.network "forwarded_port", guest: 8000, host: 8000
</code></pre>
<p>to the Vagrantfile and restart Vagrant. You can now run servers in the VM and clients (such as your favourite browser) on your own machine.</p>
<p>You might get firewall warning pop-ups, which you will have to "allow".</p>
<p>Proceed to <a href="http/explore.html">exploring HTTP</a>. If you don't have <code>wget</code> on your own machine, you can open a second terminal and log in to the VM from there, then run both <code>wget</code> and the server inside the VM that way - then later on, when you're using a browser instead of <code>wget</code> for the client, you can just open the browser on your own machine.</p>
<h2 id="over-ssh"><a class="header" href="#over-ssh">Over SSH</a></h2>
<p>For security reasons, you will not be able to run a web server on a lab machine (whether in a VM or not) and connect to it from your local web browser. If you have no other option than to use a remote connection, you should use <a href="https://wiki.x2go.org/doku.php/download:start">x2go</a> to connect to a lab machine with a graphical user interface, and run both the server and browser through that. This software uses ssh internally so you need to connect to <code>rd-mvb-linuxlab.bristol.ac.uk</code> using <code>seis.bris.ac.uk</code> as the proxy server.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="exploring-http"><a class="header" href="#exploring-http">Exploring HTTP</a></h1>
<h2 id="before-you-start"><a class="header" href="#before-you-start">Before you start</a></h2>
<p>To avoid an annoying problem, before we run our own server we are going to check that no-one else is already using the TCP port we want.</p>
<p>Run the command</p>
<pre><code>wget localhost:8000
</code></pre>
<p>on the machine where you want to run the <em>server</em>. It should time out after a couple of seconds (or instantly) with "failed" and some error message.</p>
<p>If it succeeds (shows "Connected" or "200 OK" anywhere), then someone or something else is using port 8000.</p>
<p>Next, run</p>
<pre><code>netstat -tan
</code></pre>
<p>and check that there is no line with the value "8000" under Local Address and a state of LISTEN or ESTABLISHED. If you get a lot of lines, <code>netstat -tan | grep 8000</code> will help. It does not matter if 8000 appears in the Foreign Address column, but there must be no-one using port 8000 under Local Address.</p>
<p><code>netstat</code> should work on every OS including Windows (Microsoft has written their own version), but <code>wget</code> doesn't exist by default on Windows machines although it can be downloaded for free.</p>
<p>If either <code>wget</code> or <code>netstat</code> suggests port 8000 is in use,</p>
<ul>
<li>If you are on a lab machine, it could be that another student is using port 8000 (maybe they are logged in via SSH).</li>
<li>You might have other software (such as a web development package) already using that port.</li>
</ul>
<p>You can try port numbers 8001, 8002 etc until you get one that is definitely not being used and then replace 8000 with that in all further exercises today, or (on your own machine) you can stop whatever program is using the port first.</p>
<p>Note: if you have vagrant running and set up as described on the last page, and you run <code>wget localhost:8000</code> on your own machine (not the VM), then vagrant will be using port 8000 and <code>wget</code> might block waiting for a reply. This is the correct behaviour, and this is why I asked you to run <code>wget</code> on the machine where you want to run your <em>server</em>, not the <em>client</em>. If you want to do the following exercises with both server and client on your own machine, then you need to stop the vagrant VM first or remove the 8000 line from your vagrantfile.</p>
<h2 id="a-basic-http-server-and-client"><a class="header" href="#a-basic-http-server-and-client">A basic HTTP server and client</a></h2>
<p>Open a terminal on the machine where you want to run the server, and download the file <a href="http/../resources/http-response">http-response</a> to the folder where your terminal is open (for example with <code>wget</code>). Then run the command</p>
<pre><code>nc -l -p 8000 &lt; http-response
</code></pre>
<p>Or if you are on a Mac:</p>
<pre><code>nc -l 8000 &lt; http-response
</code></pre>
<p>This calls the tool <code>nc</code> ("network cat") and tells it to listen on TCP port 8000 (<code>-l -p 8000</code>), e.g. to run a server there. When a client connects, <code>nc</code> will by default read from its standard input and write this to the client, so we use a shell redirect to make it read from a file instead. The file contains some standard HTTP:</p>
<pre><code>HTTP/1.1 200 OK
Content-type: text/plain
Content-length: 18
Connection: close

Hello over HTTP!
</code></pre>
<p>(If you want to type this out yourself or copy-paste, you <strong>must</strong> save the file with CRLF line endings and put two newlines after the hello message.)</p>
<p><code>nc</code> will block until you connect a client. Open another terminal on the machine you want to run your client and run</p>
<pre><code>wget -q -S -O - localhost:8000
</code></pre>
<p>You have now made a HTTP connection from the wget client to the nc server. The server terminal should print out the HTTP request it got from the client (this is built into wget) and the client should print out the response from the server (which comes from the file).</p>
<h2 id="connecting-with-a-web-browser"><a class="header" href="#connecting-with-a-web-browser">Connecting with a web browser</a></h2>
<p>Run <code>nc -l -p 8000 &lt; http-response</code> again on your server machine (kill the old one with <code>Control+C</code> first if it hasn't terminated already).</p>
<p>Open a web browser on your client machine (e.g. your own PC/laptop, or a lab machine). If you're using chrome/edge or firefox, open the debug tools (<code>F12</code>) and go to the network tab before you open the page.</p>
<p>Navigate to <code>localhost:8000</code>. You should see the line "Hello over HTTP!" and <code>nc</code> will print the HTTP request from your browser. You can then close it with <code>Control+C</code> if it doesn't terminate by itself. In your browser's debug tools, on the network tab you should see a file <code>localhost</code>, click this and then select <em>Headers</em> in the details that appear.</p>
<p>This details page shows you the HTTP request details, including the response code (<code>200 OK</code> in this case) and all the headers sent in both directions. This screen is one of the first places you should look at when something web-based that you've coded is not working correctly or at all, as HTTP is normally the lowest layer you need to care about.</p>
<p>In particular, the <code>Content-type</code> header is a common source of mistakes: if you want to serve e.g. a script or a stylesheet but you don't set the correct type header, your browser may download the file just fine but won't do anything with it. Similarly, whether you send <code>text/plain</code> or <code>text/html</code> determines whether the browser will interpret a file you navigate to as HTML or not.</p>
<h2 id="a-web-server-in-c"><a class="header" href="#a-web-server-in-c">A web server in C</a></h2>
<p>On your server machine, clone the repository <code>https://github.com/emikulic/darkhttpd</code> which contains a single-file web server in just under 3000 lines of C. You do not need to understand this code in detail, but it can be educational to try to understand some of what it does internally.</p>
<p>Compile the program either with <code>make</code> or simply <code>gcc darkhttpd.c -o darkhttpd</code>. The server's job is to serve files within a folder, so make a subfolder called <code>web</code> and then run it with <code>./darkhttpd web --port 8000</code>. You can stop it again at the end of the exercise with <code>Control+C</code>.</p>
<p>You can now experiment with the following:</p>
<ul>
<li>Create some files (plain text, HTML, image etc.) in <code>web/</code>.</li>
<li>Access them from your browser with <code>localhost:8000/FILENAME</code>, for example <code>web/hello.txt</code> would become <code>localhost:8000/hello.txt</code>.</li>
<li>Observe the HTTP headers in your browser's developer tools, and the server logs printed in the server terminal.</li>
</ul>
<p>This particular server is written so that if you try and access a folder instead of a file, for example just <code>localhost:8000</code> which has the implicit path <code>/</code> which maps to the <code>web</code> folder, then it shows a list of files in this folder as clickable links.</p>
<p>Pay particular attention to how the <code>Content-type</code> header is sent depending on the file extension. From the browser's point of view, that header is what counts: if you send a file with <code>.html</code> extension but set <code>Content-type: text/plain</code>, the browser would not interpret it as HTML. This makes it possible to serve URLs with no "extension" at all like <code>/students</code> for a database application, and still have the browser understand what to do.</p>
<p>From the server's point of view, this server (like most other servers that simply serve files from a folder) has chosen to use a file's extension to determine what <code>Content-type</code> to send; this is implemented in the <code>default_extension_map</code> starting at line 333 of the source file.</p>
<p>You can try this out for yourself if you want: make a HTML file called <code>one.html5</code> in the web directory and access it with the browser. (<code>.html5</code> is not an official extension, it's something I just made up. The correct one to use for proper websites is <code>.html</code>.) The server won't send a <code>Content-type</code> header at all, since it doesn't know this extension, so the browser will either display it as a plain text file or download the file instead of showing it.</p>
<p>Edit the map in the source file and change the entry for <code>text/html</code> to read <code>" html htm html5"</code>, keeping the space at the start of the string. Recompile the server.</p>
<p>Rename the file to <code>two.html5</code> (I'll explain why in a second) and restart the server and try and open the file in the browser. This time, the file will display as a HTML page.</p>
<p>Why did you have to rename the file? Because the browser will otherwise try and be clever if it thinks you're trying to access a file that you've just downloaded already. The server sends a <code>Last-modified</code> header, and if the browser notices you're asking for a file you have just downloaded, with the same timestamp as the HTTP header indicates, then your browser might ignore the rest of the request and not see that another header has changed. Changing the file name forces the browser to look again, as it thinks it's a different file now. Deleting the downloaded file, or editing the file on the server, would both have the same effect.</p>
<p>There is a moral here: if you're doing web development, and you are trying to find out why a change you made isn't showing in the browser (even if you refresh the page), it might be a cache problem. On the network tab of the developer tools window, there should be a checkbox to "disable cache" which you might want to turn on in this case and reload the page again, to exclude the cache as the possible source of the problem.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="httpurl-research-exercises"><a class="header" href="#httpurl-research-exercises">HTTP/URL research exercises</a></h1>
<p>Research online what the following are and what they do:</p>
<ul>
<li>The <em>fragment</em> part of a URL.</li>
<li>The <code>Accept</code> header sent by the HTTP client.</li>
<li>The <code>User-agent</code> header sent by the HTTP client. What does your browser send?</li>
<li>How do you encode a path that contains a space in an URL? Which other characters are "special" and need to be treated this way in paths?</li>
<li>Which web server is the University of Bristol using for <code>www.bristol.ac.uk</code>, according to the headers? Read up online on this server and the organisation of the same name that maintains it.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-server-in-java"><a class="header" href="#a-server-in-java">A server in Java</a></h1>
<p>From now on, we will be using the Java language and the Spring Boot framework to run real web servers, as you might do in a software engineering project.</p>
<h2 id="compile-and-run"><a class="header" href="#compile-and-run">Compile and run</a></h2>
<p>Make sure you have java and maven installed as we did earlier in the unit.
Clone the repository <code>git@github.com:cs-uob/COMSM0085</code> if you have not done so
already, and navigate to the folder <code>code/server01</code>. In this folder, run <code>mvn spring-boot:run</code> to compile and run the sample application. The first time you
do this, it might download lots of files.</p>
<p>This runs a web server on port 8000.</p>
<h2 id="explore-the-application"><a class="header" href="#explore-the-application">Explore the application</a></h2>
<p>The <code>pom.xml</code> file tells maven that this is a spring boot project, and what the project is called (<code>softwaretools.server01</code>).</p>
<p>Under <code>src/main/resources</code> you find two files. First, <code>application.properties</code> which is a spring file configured to run on port 8000 (the default would otherwise be 8080). Secondly, a HTML file that the application can serve.</p>
<p>Under <code>src/main/java</code> is the source code. This is only two files, but of course the whole spring framework is active when the application runs. <code>Server01Application</code> is the main class, but this just contains boilerplate code for now.</p>
<p><code>Controller.java</code> is the interesting one: in application development, <em>Model - View - Controller</em> is one of several patterns to structure an application, where a <em>Controller</em> is a piece of code that does the heavy lifting part, for example replying to a HTTP request.</p>
<p>Spring works with annotations, special classes whose name begins with an <code>@</code> sign. When the server starts, spring scans all files for annotations and sets up code to deal with them. Here we can see:</p>
<ul>
<li><code>@SpringBootApplication</code> (on the <code>Server01Application</code> class) tells spring that this is the main file to run.</li>
<li><code>@RestController</code> tells spring that this class contains methods to deal with HTTP requests. It is so named because spring has libraries to make implementing the REST principles particularly easy.</li>
<li><code>@AutoWired</code> on a field tells spring that this field is spring's responsibility to set up when the application starts. The <code>ResourceLoader</code> is part of spring and lets you access files in <code>src/main/resources</code>.</li>
<li><code>@GetMapping(PATH)</code> tells spring that this method should be called to reply to a HTTP GET request for the provided path (there is of course also a <code>@PostMapping</code> and so on).</li>
</ul>
<p>The <code>mainPage</code> method, which is called when you load <code>localhost:8000</code>, shows the basic way to reply to a HTTP request: set up any headers you need - in this case the content type - and return a <code>ResponseEntity</code> taking three parameters: the HTTP body of the response to return (this will be shown in your browser), the HTTP headers to set, and the response code which is 200 (OK) here.</p>
<p>The <code>htmlPage</code> method replies to requests for <code>localhost:8000/html</code>. Here we want to serve a file, so we use the resource loader to get it from the classpath which includes the <code>src/main/resources</code> folder (or rather, the version of it that ends up in the compiled JAR file). It also shows a second way to create a <code>ResponseEntity</code> using the <em>builder</em> pattern.</p>
<h2 id="exercises-1"><a class="header" href="#exercises-1">Exercises</a></h2>
<ul>
<li>Compile and run the application, and test both <code>localhost:8000</code> an <code>localhost:8000/html</code> in your browser. Observe both the headers in the developer tools, and the log messages that spring prints out for each request.</li>
<li>Add a method that replies to requests for <code>localhost:8000/bad</code> with a HTTP <code>404 NOT FOUND</code> error. The body of the page can be a simple string with a message of your choice. Stop and restart the application, and check that you get the correct error message when you try and open this page.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="html5"><a class="header" href="#html5">HTML5</a></h1>
<p>HTML5, officially introduced in 2014, is the modern markup language for writing websites.</p>
<p>It gets rid of a lot of historical annoyances and inconsistencies from previous versions of HTML and XML and contains a lot of new standard tags and attributes for features that individual sites had built with JavaScript or Adobe Flash in the past. For example, HTML5 has a <code>&lt;video&gt;</code> tag for a consistent way to include videos that work across different platforms and without plug-ins, and a standard way of writing a date picker or "calendar" widget.</p>
<h2 id="videos-1"><a class="header" href="#videos-1">Videos</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Video</th><th style="text-align: right">Length</th><th>Slides</th></tr></thead><tbody>
<tr><td><a href="https://web.microsoftstream.com/video/60b286e4-2a48-457c-b564-fec86ee2169d">HTML5</a></td><td style="text-align: right">16 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/Ea3-DaFYa9RItnmSRhVGPXIBGAS_PHaWAKGgeuay7Zf1kg?e=0rxeGt">slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/eccbed8b-eca0-4d67-a4fe-ac9f440e422d">HTML elements</a></td><td style="text-align: right">9 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/ERJbx2SsLUlDtuutM2Iort0BkVM4OmX4cfK1v79eixrtqA?e=CrgGEv">slides</a></td></tr>
</tbody></table>
</div>
<h2 id="mdn"><a class="header" href="#mdn">MDN</a></h2>
<p><em>For the web part of the unit, we will be reading some of the documentation on the Mozilla Developer Network (MDN) for some workshops, to complement the videos and exercises.</em></p>
<p>These pages are pitched at a lower level of technical expertise than CS students, so you should get through them very quickly. Many of them also contain interactive examples to try out. If your future career involves web development, you will be consulting documentation like the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML">MDN HTML reference guide</a> a lot - for example, to read through all the attributes you can put on a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form">form tag</a>.</p>
<p>Please read the following pages for this workshop, as well as watching the videos.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML/Getting_started">MDN: Getting Started with HTML</a> The very basics, and the HTML5 page template.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML/HTML_text_fundamentals">MDN: HTML Text Fundamentals</a> A recap of paragraphs, headings, styling, semantic tags.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML/Creating_hyperlinks">MDN: Creating Hyperlinks</a> All about the <code>&lt;a&gt;</code> tag.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML/Document_and_website_structure">MDN: Document and website structure</a> HTML5 semantic tags for structure.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/HTML5_input_types">MDN: HTML5 input types</a> More on using the most appropriate controls in your forms.</li>
</ul>
<h2 id="exercises-2"><a class="header" href="#exercises-2">Exercises</a></h2>
<ul>
<li><a href="html5/./basic.html">Basic HTML5</a></li>
<li><a href="html5/./templates.html">Templates</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="basic-html5"><a class="header" href="#basic-html5">Basic HTML5</a></h1>
<p>For your first exercise, create a page called <code>index.html</code> and add the HTML5 template code to it.</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
 &lt;head&gt; 
   &lt;meta charset="utf-8" /&gt;
   &lt;title&gt;A web page&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
    &lt;h1&gt;An example web-page&lt;/h1&gt;
    &lt;p&gt;A paragraph of text here, perhaps with &lt;a href='./another_page/'&gt;a link&lt;/a&gt;&lt;/p&gt;
 &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>The name <code>index.html</code> is a convention: most web servers, if you give an URL that looks like a "folder" e.g. <code>example.com/pages</code> (or <code>example.com/pages/</code> with slash on the end) will serve the file <code>index.html</code> from within that folder, if there is one.</p>
<h2 id="create-a-page"><a class="header" href="#create-a-page">Create a page</a></h2>
<p>Create content in your page to make it look like the following, then open it in your browser. All body text, but not the bullet list, is contained in paragraph tags.</p>
<div style="background:#fff; border: 1px solid #1d1b1e; box-shadow: 0px 0px 10px #333; width: 100%; height: 490px; border-radius: 5px;">
<div style="height:40px; background-color: #1d1b1e; display:flex; justify-content: start; align-items: center; padding: 0 1em; border-radius: 5px 5px 0 0;">
    <div style="display: flex; font-size: 1rem;">
        <div style="background: #c43e3e; border-radius: 100%; width: 1em; height: 1em; margin: 0 0.5em;"></div>
        <div style="background: #c1a347; border-radius: 100%; width: 1em; height: 1em; margin: 0 0.5em;"></div>
        <div style="background: #4b3cb5; border-radius: 100%; width: 1em; height: 1em; margin: 0 0.5em;"></div>
    </div>
    <div style="font-family: monospace; font-size: 0.8em; background: #eeeeee; color: #1d1b1e; padding: 0.2em 0.5em; border-radius: 5px; margin-left: 1em; margin-right: 5em; flex-grow: 1;">http://localhost:8000</div>
</div>
<iframe style="border: none; width: 100%; height: 450px" src="../resources/examplepage.html" title="example page">
</iframe>
</div>
<h2 id="validate-your-page"><a class="header" href="#validate-your-page">Validate your page</a></h2>
<p>There are various libraries and services that check if your page is valid HTML5.</p>
<p>At <a href="https://validator.w3.org/">validator.w3.org</a> you can enter an URL, upload a file, or paste the contents of a file and validate it. Check that the page you have just written is valid HTML5.</p>
<p>Your browser's developer tools can also check the page you are viewing. For Chrome/Edge, to to the <em>Console</em> tab and, if the button at the top does not read <em>No Issues</em> but shows a number with a blue (or even yellow or red) icon, then click it to open the <em>Issues</em> tab and see what the browser is complaining about.</p>
<p>You can check the sample solution <a href="html5/../resources/examplepage.html">here</a> but you might have a different, equally valid solution.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="templating"><a class="header" href="#templating">Templating</a></h1>
<p>The bread and butter of many developer jobs is building web applications that let people interact with data in a database. In a university for example, such an application might let students see the units they are enrolled in, their teaching and exam timetables, and their grades. Academics would be able to add new grades, and staff in the timetabling office would be able to create and edit timetables.</p>
<p>In such an application, pages need to be somewhat dynamic: the "student profile" page will show data for the particular student that you are looking at. Rather than generating these HTML pages "manually", for example by pasting strings together, it is much cleaner and usually more efficient to use a templating library. You could define one "student profile page" template, and then when a student requests their profile page, the server uses the template to create the page with this student's data. Creating a particular page from a template and some data is called <em>rendering</em> the page.</p>
<p>This workshop's example application is <code>code/server02</code> in the unit git repository. You build it with <code>mvn spring-boot:run</code> like the previous one, then access <code>localhost:8000</code>.</p>
<p>The application is a very minimal university database with students, units and grades. The <code>Database</code> interface in the <code>model</code> folder, together with the Student and Unit classes, form the data model - you can search for all students or all units in the database. In a real database of course, you would be able to search for an individual student by ID as well.</p>
<p>The file <code>Templates.java</code> sets up the <a href="https://www.thymeleaf.org/">thymeleaf</a> template engine. The <code>@Component</code> annotation tells spring to manage this class; other classes that need templates can request it by declaring a field of the right class with <code>@Autowired</code>, as you can see in <code>Controller.java</code>.</p>
<p>The main page is served up as before as a HTML file from the classpath in <code>src/main/resources/web</code>.</p>
<p>Have a look at the process when <code>/units</code> is requested.</p>
<ul>
<li>First, the method <code>unitsPage</code> accesses the database and loads the list of units.</li>
<li>Next, it creates a <code>Context</code>, a thymeleaf object that lets you pass values to a template. Here we add one value with key <code>units</code>, containing the list of units.</li>
<li>Finally, we render the template with the context and return this. If a method in a spring controller returns a string, then the string is assumed to contain a HTML page and spring correctly sets the HTTP status code and headers.</li>
</ul>
<p>The template itself is in <code>src/main/resources/units.html</code>. Anything with a <code>th:</code> prefix is rendered by thymeleaf:</p>
<pre><code class="language-html">&lt;ul th:each="unit : ${units}"&gt;
    &lt;li&gt;
        &lt;a th:href="'/unit/' + ${unit.code}" th:text="${unit.code}"&gt;&lt;/a&gt;
        &lt;span th:text="${unit.title}"&gt;&lt;/span&gt;
    &lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<p>The <code>th:each</code> attribute is the equivalent of a for loop in Java, in this case <code>for (Unit unit : units)</code> - in thymeleaf, unlike plain Java, you do not need to give the loop variable a type but you do need to use the <code>${...}</code> syntax whenever you are accessing a variable from the context. The <code>th:each</code> attribute renders its own tag once (in this case <code>&lt;ul&gt;</code>) and then renders everything inside the tag once per pass through the loop, so you get one <code>&lt;li&gt;</code> item per unit.</p>
<p>To create an attribute, you put <code>th:</code> in front of the attribute name, so the <code>th:href</code> creates the <code>href</code> attribute of a link (check the result in your browser). Thymeleaf attribute syntax is that you need to put single quotes around strings, <code>+</code> like in Java to stick strings together, and <code>${...}</code> around variables.</p>
<p>The syntax <code>${instance.attribute}</code> loads an attribute from an instance of a Java class by calling its getter. In this case <code>${unit.code}</code> ends up calling <code>.getCode()</code> on the unit instance rather than accessing the field directly.</p>
<p>The <code>th:text</code> attribute is special and creates the body of a tag. For example, the span tag here creates a <code>&lt;span&gt;</code> whose body (between the opening and closing tags) contains the unit's title. Thymeleaf, unlike some other templating systems, doesn't let you include variables everywhere - some template engines let you just write <code>${variable}</code> anywhere in the HTML page, but thymeleaf only lets you do that in an attribute of a tag so if you simply want some text, you need to make a placeholder tag (<code>span</code> is a good choice here) and put the variable in its <code>th:text</code> attribute.</p>
<p>If you click on a unit, you get to the details page for that unit (that
currently doesn't have any more detail than the code and title). When you send a
HTTP request for <code>/unit/UNITCODE</code>, for example <code>/unit/COMSM0085</code>, this is
handled by the <code>unitDetailPage</code> method.</p>
<p>Note that the <code>@GetMapping</code> contains a pattern <code>/unit/{code}</code> with a parameter to match all URLs of this form, and the parameter is passed to the method as a parameter that is annotated with <code>@PathVariable</code> to tell spring how to deal with it, namely to fill its value from the path of the HTTP request.</p>
<p>The method first finds the unit in the database and returns a 404 error page if there is no unit with that code. (In a real database, there would be a "find unit by code" method, you would not have to load all units just to find one of them.)</p>
<p>After this, we call thymeleaf on the <code>unit.html</code> template (this is the one without 's' in its name) to render the unit page.</p>
<h2 id="exercises-3"><a class="header" href="#exercises-3">Exercises</a></h2>
<p><strong>Basic exercise:</strong> Rewrite the units list page to show the units in a table instead of a list. The table should have one row per unit and three columns: the first column should be the unit code, the second should be the unit title, and the third column should contain a link with text "details" that takes you to the details page for the unit. Also make a header row in the table with headings 'code', 'title' and 'link'. (This is purely a HTML and templating exercise, you do not need to change any Java code for this.)</p>
<p><strong>Intermediate exercise:</strong> Implement controller methods and templates for listing all students and viewing an individual student's details, analogous to the ones for units (you can choose whether you make a list or a table for the students - there are currently only two). You only need to show a student's id and name for now, not the grades. Note that the id is an integer, not a string. You can copy-paste the Unit controller code and templates and make the necessary changes to show students instead, but make sure you understand what the bits do that you're changing. The student class is in the <code>src/main/java/softwaretools/server02/model</code> folder.</p>
<p><strong>Intermediate exercise:</strong> The student class contains a method <code>getGrades()</code> that returns a list of pairs (unit, grade). The unit is a unit object, and the grade is an integer. On your student details page, make a table listing the titles and codes of all the units the student has taken, and the grades they got.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="css"><a class="header" href="#css">CSS</a></h1>
<p>CSS, or Cascading Style Sheets, allows you to set what your page looks like, separately from creating the content.</p>
<p><em>Not to be confused with <a href="https://cssbristol.co.uk/">CSS Bristol</a>.</em></p>
<h2 id="videos-2"><a class="header" href="#videos-2">Videos</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Video</th><th style="text-align: right">Length</th><th>Slides</th></tr></thead><tbody>
<tr><td><a href="https://web.microsoftstream.com/video/966c07b6-6f2f-4676-b348-e942101be174">CSS part 1</a></td><td style="text-align: right">14 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EXPRGR7nfbdLgB8krc9jTFcBHEH__HvV-vqXfbmYemGfnA?e=lwKNBI">slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/b38974b4-2675-4143-82c8-a8ff2c6a3288">CSS part 2</a></td><td style="text-align: right">10 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EaPEjEpM1JtNkDwYQyQ8tCUBFT6Q78VI4QKMSANf6jhfyg?e=VIS7eB">slides</a></td></tr>
</tbody></table>
</div>
<h2 id="mdn-1"><a class="header" href="#mdn-1">MDN</a></h2>
<p>For this workshop, please read the following pages:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/First_steps">CSS first steps</a> including the 5 subpages linked under "Guides" - they are all meant for beginners so you should be able to get through them quickly.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/Selectors">CSS selectors</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/The_box_model">The box model</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/Values_and_units">Values and units</a></li>
</ul>
<h2 id="exercises-4"><a class="header" href="#exercises-4">Exercises</a></h2>
<ul>
<li><a href="css/./text.html">Styling Text</a></li>
<li><a href="css/./framework.html">Frameworks</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="styling-text"><a class="header" href="#styling-text">Styling Text</a></h1>
<p>Under <a href="css/../resources/sometext.html">resources/sometext.html</a> you have a basic text-based HTML document with some information about your degree. Download this file and open it in your browser, you will see it displayed with the default stylesheet (and any customisations you might have applied, such as selecting a default font and size).</p>
<h2 id="reading-mode"><a class="header" href="#reading-mode">Reading Mode</a></h2>
<p>Many browsers have a <em>reading mode</em> which is meant to make text as east to read as possible. Let's simulate this - create a new link to a stylesheet in the header (call it something like <code>sometext.css</code>) and insert the following:</p>
<pre><code class="language-css">body {
    margin: 0 auto;
    max-width: 40em;
    line-height: 125%;
}
</code></pre>
<p>This already looks much better, but you can play with the parameters to get something that's perfect for you.</p>
<ul>
<li>The <code>max-width</code> is doing most of the work here, following the design principle (that's fairly well replicated with studies) that most people find text easier to read if lines are not much longer than some limit, quoted variously as <a href="https://baymard.com/blog/line-length-readability">around 60 characters</a>. Since an 'm' is wider than the average character and <code>em</code> rather than e.g. <code>px</code> is the correct thing to use here (as it's relative to the font being used), I went for 40em.</li>
<li>The <code>margin: 0 auto</code> centers content horizontally if it has a fixed width. The space around the text both gets the left margin away from the edge of the window, and gives the eye an area around the text free of distractions.</li>
<li>Increasing the line height follows the same principle, sometimes known as giving the text <em>room to breathe</em>. Experiment with differnt line heights if you like to see which one suits you best. Note: it's possible to overdo this. Double-spacing (<code>line-height: 200%</code>) was common for dissertations in the typewriter era, mainly to give proofreaders and markers space to write comments between the lines. This is considered bad design nowadays, and you should not do it.</li>
</ul>
<p>If you want, you can try a few other things:</p>
<ul>
<li>Change the <code>font-size</code>. The default is <code>16px</code> but depending on your screen size, resolution and distance from your eyes you might want a larger one.</li>
<li>Set a different <code>font-family</code>. The values <code>serif</code> and <code>sans-serif</code> give default choices across all operating systems, you could set this to a more specific font on yours such as <code>Calibri</code> (if on Windows) but bear in mind this will not work for Mac users.</li>
<li>Set a <code>background-color</code> on the body, either a light but not quite white one (pale yellow/brown is often used), or go dark mode with a dark backround and a light <code>color</code> for the font itself.</li>
</ul>
<div class="advanced container">
<header><span class="advanced-title"></span></header>
<div class="container-content">
<p>Tricks like this - which you can code as a browser extension if you want to - might be particularly helpful for visually impaired or dyslexic students so you can force any website to use fonts and styles that work for you.</p>
<p>If you are designing for dyslexic people other than yourself, the best you can do is give them a way to configure the fonts and colours themselves (for example with a menu that lets you change them via JavaScript) - different dyslexic people might have different preferences that work for them, for example one person may prefer serif fonts to sans-serif or the other way round, there is no one best design for everyone.</p>
<p>There are statistical trends which mean that "use sans serif fonts" is good advice if you have to pick one font (for example for printed material) but one of the advantages of the web is that you do not have to choose one font in advance, you can let different users select different preferences.</p>
</div>
</div>
<h2 id="starting-from-scratch"><a class="header" href="#starting-from-scratch">Starting from Scratch</a></h2>
<p>Uncomment the line that includes <code>reset.css</code> in the HTML file (comments go from <code>&lt;!--</code> to <code>--&gt;</code>, a relic of when HTML was connected with XML). The file is at <a href="css/../resources/reset.css">resources/reset.css</a> so download it to the same folder as your HTML file.</p>
<p>You now have almost no styling at all: headings, lists, paragraphs all just look like text.</p>
<p>In your own stylesheet, which you should include <em>after</em> <code>reset.css</code>, either try and recreate the default settings or try out ones that look good to you.</p>
<p>Headings are meant to stand out among the paragraphs, and the extra white space around them (padding or margin) is as important as the larger font size and bold font. You could try leaving headings the same size as the body font but still <code>font-weight: bold</code> and use just padding to make them stand out. (Since a heading relates to the text after it not the text before it, it is good design to have a greater margin/padding above the heading than below it.)</p>
<p>The default body font size is <code>font-size: 16px</code>. If you want to make the headings larger, you should not set an absolute value (such as 24px) but one relative to the default size. Since the default size comes from the <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> elements, you have two ways to do this: either with a percentage e.g. <code>h1 { font-size: 150%; }</code> which makes headings 1.5 times as big as the paragraph font, or using the <code>em/rem</code> units (setting a font size in ems refers to the em size of the parent unit).</p>
<p>In the browser, open the developer tools and type the following in the console and press ENTER:</p>
<pre><code class="language-js">document.body.style.fontSize="24px";
</code></pre>
<p>(Since this is JavaScript, the property is called <code>fontSize</code> not <code>font-size</code> as dashes are not allowed in identifiers.)</p>
<p>This increases the body text size from 16px to 24px (if you have manually set a different size in your stylesheet, you might need to set it to <code>"24px !important"</code> to override this). If you had set your headings to fixed sizes like 18px, then headings would now be smaller than the body text - if you have correctly used relative sizing, then headings will now still be 1.5 times as big as the body fonts or whichever multiple you set them to be. That is the right way to do it.</p>
<h2 id="vertical-rhythm"><a class="header" href="#vertical-rhythm">Vertical Rhythm</a></h2>
<p>Here is another design principle worth knowing about. Look at this image, part of a screenshot of one way to style the text on the page:</p>
<p><img src="css/rhythm1.png" alt="text in vertical rhythm layout" /></p>
<p>The principle here is that we imagine a grid with 20px high lines, and lay out everything according to that. Under <a href="css/../resources/baseline.png">resources/baseline.png</a> there is an image 1px wide and 20px high with the last pixel coloured pink. Download that image to the folder with the HTML file and set</p>
<pre><code class="language-css">body {
    background-image: url("baseline.png");
}
</code></pre>
<p>This will make the image repeat horizontally and vertically, and you can now see the design behind this approach:</p>
<p><img src="css/rhythm2.png" alt="text in vertical rhythm layout" /></p>
<p>The baselines of the paragraph text all sit on the grid lines. The important thing here is that when a heading interrupts the flow of text, the total height of the heading is an exact multiple of the grid height, even if the font size is different.</p>
<p>Try and recreate this layout or a similar one using vertical rhythm, starting from the reset stylesheet so you have to do everything yourself from scratch. Notes:</p>
<ul>
<li>The aim is that all paragraphs have their baselines on the grid, even if there are other elements (headlings, lists) earlier in the document.</li>
<li>This means that the total height of headings must be an exact multiple of the grid size; you can assume that the text in a heading does not require more than one line.</li>
<li>You should set all sizes, including margins and padding, in terms of relative units (either ems/rems or percentages).</li>
<li>The base font size here is the default 16px. Start with the max-width and line-height from the first example, and modify the line height if necessary for your font to get the lines of paragraph text the right distance apart.</li>
<li>The paragraphs themselves have a margin at the bottom (the empty line after the first paragraph) that also appears between paragraphs of text (not shown in the image) when one <code>&lt;p&gt;</code> tag follows another. You might also need to give them a small top padding to get the text on the lines, not between them.</li>
<li>The shading around the headings is <code>background-color: rgba(0, 0, 255, 0.25);</code> to be semitransparent and let the lines show through, to see that while the heading text itself doesn't have to sit on a grid line, the total height of a heading including padding does respect the grid. However this shading is just to motivate the layout: if you want an actual coloured background, then you should set a <code>padding-left: 0.5em;</code> or something on the headings to make the text not start just on the edge of a coloured box. This improves readability.</li>
<li>You will also need to style the <code>&lt;ul&gt;</code> list to have some spacing before and after, and to keep everything on the grid lines. You get the bullets back with the following code - or one of many other options <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/list-style">listed on MDN</a>:</li>
</ul>
<pre><code class="language-css">ul {
    padding-left: 2em; /* the bullets appear in the padding */
    list-style-type: disc;
    list-style-position: outside;
}
</code></pre>
<ul>
<li>Don't forget to style the link. <code>text-decoration: underline</code> is one option; or you can read more on MDN about <a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/Styling_text/Styling_links">styling links</a> including how to make a link someone has visited before look different to a new one.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-a-css-framework"><a class="header" href="#using-a-css-framework">Using a CSS Framework</a></h1>
<p>Now that you know some CSS, you could write your own framework - one or more stylesheet files that implement your idea of good design. In this exercise we will look at some examples.</p>
<h2 id="milligram"><a class="header" href="#milligram">Milligram</a></h2>
<p><a href="https://milligram.io">Milligram</a> is, in its own words, a "minimalist CSS framework".</p>
<p>Download the <a href="css/../resources/page1.html">page1.html</a> file and open it in the browser: it contains some text and a sign-up form for a CSS conference.</p>
<p>Add the following to the page head:</p>
<pre><code class="language-html">&lt;link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic"&gt;
&lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css"&gt;
&lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.css"&gt;

</code></pre>
<ul>
<li>The first one loads Google's <a href="https://fonts.google.com/specimen/Roboto">Roboto web font</a>, which the designers of Milligram selected as their default. Because it is loaded as a web resource, it should work across different browsers and operating systems, you don't need to install it first.</li>
<li>The next line loads <code>normalize.css</code>, an alternative to <code>reset.css</code> that provides a consistent stylesheet across browsers. Try out the page with just the first two stylesheets and see how it looks now - the font won't have changed because no-one has set <code>font-family</code> yet, that will happen in the next stylesheet, but the margins will be slightly different.</li>
<li>The third one adds Milligram itself. Your page now uses a different style, for example the form fields and labels are laid out vertically and the register button is purple.</li>
</ul>
<p>Milligram chooses to style the whole page by default, but you can customise this further. One of their features is a <em>container</em> that gives its content a fixed maximum width.</p>
<ul>
<li>Add <code>class="container"</code> to the <code>&lt;main&gt;</code> element, save and reload. See how the page behaves when you make the window wider and narrower. The page will always have some left/right padding, but the form adapts to the window size.</li>
<li>In the developer tools, activate mobile mode a.k.a. <em>toggle device emulation</em>, on chrome/edge this is the second icon from the left in the top left of the developer panel. The text looks much too small now!</li>
<li>This is due to a number of factors including higher pixel density on mobile screens. Milligram can handle mobile devices, but it needs the following line in the header:</li>
</ul>
<pre><code class="language-html">&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
</code></pre>
<p>This line, which is often (but not always) good practice to include in a HTML5 page anyway, tells a mobile browser (or a device pretending to be one) to adopt sensible defaults including larger fonts depending on the pixel density and no horizontal scrollbars. You can read more about this <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Viewport_meta_tag">on MDN</a>.</p>
<p>On <a href="https://milligram.io/#typography">the milligram documentation page</a> you can read more about the elements that Milligram styles for you, and how you can customise this (e.g. buttons).</p>
<p>Have a look in your browser's developer tools at how Milligram styles the page: select an element in the <em>Elements</em> tab (or right-click it and choose <em>Inspect</em>), then look at the styles that appear in the <em>Styles</em> area. How does Milligram set the following?</p>
<ul>
<li>Size of heading fonts</li>
<li>Form fields take up the full width of the container</li>
<li>Form labels and fields appear below each other</li>
<li>Labels are closer to their own field than the field above</li>
<li>Size and centering of everything in a container on wide enough screens</li>
</ul>
<h2 id="bulma"><a class="header" href="#bulma">Bulma</a></h2>
<p><a href="https://bulma.io">Bulma</a> is a larger but still fairly lightweight CSS framework. Unlike Milligram, it only styles parts of the page you tell it to (but it sets a default font), and it has some more components to build things like menus or panels.</p>
<p>Start with <a href="css/../resources/page2.html">page2.html</a>, have a look at the raw page and then add the following to the header (the viewport tag is already there):</p>
<pre><code class="language-html">&lt;link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.css"&gt;
</code></pre>
<div class="advanced container">
<header><span class="advanced-title"></span></header>
<div class="container-content">
<p>Bulma, like most frameworks, comes in two formats: <code>bulma.css</code> is the CSS file with human-readable formatting, and <code>bulma.min.css</code> (at the same location) is the minified version with all unnecessary whitespace removed and so is slightly quicker to download.</p>
<p>The bulma sources <a href="css/github.com/jgthms/bulma">on github</a> are actually in SASS format, a language that compiles to CSS but offers extra features in the source file like nested blocks and variables. (After SASS was created, variables were introduced in CSS too, but with a different syntax.)</p>
</div>
</div>
<p>Bulma works with custom class names. For example, we are going to make the first heading into a banner that spans the whole page width - called a <em>hero</em> in web design circles. Bulma has classes for this.</p>
<ul>
<li>First, add <code>class="title"</code> to the h1 heading, save and reload the page.</li>
</ul>
<p>This tells bulma to style it as a title/heading element. On the <a href="https://bulma.io/documentation/elements/title/">title element page</a> you can see that the correct way to get a top-level heading is with the classes <code>"title is-1"</code>, whereas a <code>"title is-2"</code> would be a second-level heading (slightly smaller font):</p>
<pre><code class="language-html">&lt;h1 class="title is-1"&gt;Title 1&lt;/h1&gt;
&lt;h2 class="title is-2"&gt;Title 2&lt;/h2&gt;
</code></pre>
<p>This looks like you are saying the same thing twice, and you are, but it lets you keep the structure and the styling separate - tag names give structure, class names give styling. Note that this method is a convention by the bulma designers, which other designers might not agree with, not part of the HTML/CSS standard.</p>
<p>Now to the hero part. According to the bulma documentation for the <a href="https://bulma.io/documentation/layout/hero/">hero component</a>, we need a container with class <code>hero</code> and a direct child with class <code>hero-body</code>, so</p>
<ul>
<li>Add class <code>hero</code> to the header tag.</li>
<li>Add a child div <code>hero-body</code> inside it that wraps the <code>h1</code> tag.</li>
<li>Set the classes <code>title is-1</code> on the h1 tag itself.</li>
</ul>
<p>You now have an eye-catching element at the top of your page.</p>
<p>Bulma also lets you give an element the class <code>content</code> to tell it to style everything within that tag based on the tag names. Class <code>section</code> creates a section with spacing before/after, and class <code>container</code> makes something fixed width and centered.</p>
<ul>
<li>Add class <code>content</code> on the <code>main</code> tag. Reload the page and observe the changes.</li>
<li>Add a <code>div</code> inside main that wraps all the content inside, and give it class <code>container</code>. Reload again and observe the change.</li>
<li>Notice that the first h2 heading text touches the bottom of the hero area, which is not good design - text needs space between it and edges of coloured areas. Create a section tag as the direct child of the container, and give it class <code>section</code> so your code should look like this:</li>
</ul>
<pre><code class="language-html">&lt;main class="content"&gt;
    &lt;div class="container"&gt;
        &lt;section class="section"&gt;
            ... content ...
</code></pre>
<p>For the next exercise, style the form.</p>
<ul>
<li>Put another section tag around the form and its heading (so the container tag will have two direct children, both of them sections).</li>
<li>Using the bulma <a href="https://bulma.io/documentation/form/general/">form documentation</a>, add tags and classes to the form as necessary so it looks similar to the Milligram one (full width fields, labels immediately above the fields, coloured button with rounded corners). You don't have to make the button purple, use <code>is-primary</code> to make it blue.</li>
</ul>
<p>Finally, add and style a <a href="https://bulma.io/documentation/components/">bulma component</a> of your own choice on the page.</p>
<h2 id="bootstrap"><a class="header" href="#bootstrap">Bootstrap</a></h2>
<p>The most popular CSS framework is <a href="https://getbootstrap.com">bootstrap</a>, developed by Twitter. If you are interested and have some spare time, you can have a look at it - it has lots of different components and options to customise the styling further with themes.</p>
<p>Bootstrap includes a JavaScript file as well as a stylesheet: for some components like tabbed pages, you need the scripts to make clicking on a tab switch to the correct content.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="css-grids"><a class="header" href="#css-grids">CSS grids</a></h1>
<h2 id="videos-3"><a class="header" href="#videos-3">Videos</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Video</th><th style="text-align: right">Length</th><th>Slides</th></tr></thead><tbody>
<tr><td><a href="https://web.microsoftstream.com/video/ef9e9dcf-f9b8-4bcf-8ac6-f8608514cc22">Design</a></td><td style="text-align: right">13 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EUlNRBt92L9MmCs7UUPFCnsBfrW30OIZiFGjrzvBEdPAGQ?e=FmmJEW">slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/93c2a47c-5fd4-432d-9f93-71e7181fd104">CSS grids</a></td><td style="text-align: right">7 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EbxgG7O3lb1MoSgwQuUMDZ8B8WBnR0ZyiBD0Q1hQk9P9eg?e=ks2kqT">slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/d2099c95-eef3-474e-9ae8-4f5a84521d18">Responsive Layout</a></td><td style="text-align: right">3 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/Ebvt4NOYIGtHvJDTNsbXK4kBzon6XArErDCWxs74DzyNgA?e=jJRS8E">slides</a></td></tr>
</tbody></table>
</div>
<h2 id="mdn-2"><a class="header" href="#mdn-2">MDN</a></h2>
<p>Please read the following pages, and play with the interactive examples:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/CSS_layout/Normal_Flow">Normal flow</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/CSS_layout/Grids">CSS grids</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/CSS_layout/Media_queries">Media queries</a></li>
</ul>
<h2 id="exercises-5"><a class="header" href="#exercises-5">Exercises</a></h2>
<ul>
<li><a href="cssgrid/./intro.html">Introduction</a></li>
<li><a href="cssgrid/./curriculum.html">Curriculum exercise</a></li>
<li><a href="cssgrid/./trees.html">Trees (responsive layout)</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="css-grids-introduction"><a class="header" href="#css-grids-introduction">CSS grids introduction</a></h1>
<p>To create a CSS grid, you place a container element (usually a <code>&lt;div&gt;</code>) and style it <code>display: grid</code>. All its direct children will now be laid out in a grid, and you can configure the general layout on the parent element:</p>
<ul>
<li><code>grid-template-columns</code> defines the number and widths of the columns.</li>
<li><code>gap</code> (which should have been called <code>grid-gap</code>, but is not) defines the gap between different grid cells.</li>
<li>For a gap around the outside of the grid, give the container a margin (or padding).</li>
</ul>
<p>On the child elements, you can set the placement rules for each one and the browser will build the grid accordingly:</p>
<ul>
<li>By default, each child takes up the next free 1x1 space.</li>
<li><code>grid-row</code> and <code>grid-column</code> modify this:
<ul>
<li><code>span N</code> makes a child element N cells wide/tall.</li>
<li><code>M / N</code> positions the child absolutely from dividing line M to dividing line N (you can overlap or stack elements on top of each other this way if you want to).</li>
</ul>
</li>
</ul>
<p>There are many more things that you can do with grids, and your best resources if you need to look this up are:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/CSS_layout/Grids">Grids on MDN</a></li>
<li><a href="https://css-tricks.com/snippets/css/complete-guide-grid/">CSS-tricks complete guide to grids</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="exercise-curriculum"><a class="header" href="#exercise-curriculum">Exercise: Curriculum</a></h1>
<p>Download the file <a href="cssgrid/../resources/curriculum.html">curriculum.html</a> and open it in an editor.</p>
<p>You can see that it references a stylesheet file <code>curriculum.css</code> in the same folder, so create that file.</p>
<p>Your task is to write a stylesheet to make the curriculum look like this (for this exercise, we do not care about responsive layout):</p>
<p><img src="cssgrid/curriculum.png" alt="image of the curriculum" /></p>
<p><em>(If you are a MEng student, mentally replace "individual project" with "group project" in 3rd year and then 4th year should follow the same layout as 3rd year, but you don't have to edit this in the file for this exercise.)</em></p>
<p>The units are coded like this in the file:</p>
<pre><code>&lt;main&gt;
    &lt;div class="unit y1-tb1 cp20"&gt;
        &lt;b&gt;COMS10014&lt;/b&gt;
        &lt;p&gt;Mathematics A&lt;/p&gt;
    &lt;/div&gt;
</code></pre>
<p>Each unit is a <code>&lt;div&gt;</code> with class <code>unit</code> and further classes declaring its teaching block and weight in credit points. SPE in year 2 is special and is the only unit declared as <code>y2-tb4</code> with no CP class. By the way, why did we choose <code>cp20</code> and not <code>20cp</code> as the class name?</p>
<p>We are being pedantic here about separating content/structure (in the HTML file) and styling/layout (which you will write in a CSS file). There is no hint in the HTML file that the aim of the exercise is to lay the units out on a grid!</p>
<div class="advanced container">
<header><span class="advanced-title"></span></header>
<div class="container-content">
<p>Our class names are purely semantic - they describe attributes of the units (academic year, teaching block, credit points), not how they should be displayed. There is some debate among web developers and designers just how far you should take this separation; we are being absolutely purist for this exercise, but even bootstrap, one of the most widely used web libraries, has classes like <code>.col-4</code> to make something four columns wide. In practice the answer to how you separate concerns between HTML and CSS is really a case of "it depends".</p>
</div>
</div>
<p>Some general styles that you can apply in your <code>curriculum.css</code>:</p>
<pre><code class="language-css">body {
    font-family: sans-serif;
    background-color: rgba(112, 145, 53, 0.1);
}

.unit {
    background-color: rgba(0, 67, 79, 0.2);
}

.unit b {
    display: block;
    background-color: rgb(0, 67, 79);
    color: white;
    padding: 5px;
}

.unit p {
    padding: 5px;
}
</code></pre>
<p>This sets the colour scheme (derived from the official University of Bristol one), and some sensible padding/margins. The <code>&lt;p&gt;</code> elements already come with a default margin that we don't want to change here, but note that we applied the background colour for the text boxes to the <code>&lt;div class="unit"&gt;</code> element itself, not the <code>&lt;p&gt;</code> elements otherwise the margin of the <code>&lt;p&gt;</code> elements would not be coloured in. The 5px paddinjg that we declared everywhere creates some space between the text and the edge of the boxes, which makes the text easier to read.</p>
<p>We used <code>&lt;b&gt;</code> tags for the title bars that are normally inline elements, but we redefined them to be block elements here (this is allowed) so they span the whole width of their grid cell.</p>
<h2 id="exercise"><a class="header" href="#exercise">Exercise</a></h2>
<ul>
<li>The grid should be applied to the <code>&lt;main&gt;</code> element, with 12 equally wide columns and a maximum width of 1500px overall; you can center the grid for even wider screens with <code>margin: 0 auto;</code> on the main element.</li>
<li>The gap between grid cells is <code>15px</code>.</li>
<li>10CP units should take up 2 of the 12 columns in width, 15CP units 3 columns, and 20CP units 4 columns. The 40CP project is 8 columns wide.</li>
<li>All units are one row high except SPE which is 2 rows high.</li>
<li>The aim of the exercise is not to write an individual rule for each unit! Try and use as few rules as necessary, you can do it with one rule per individual class that appears in the source file (you can even do it with a couple of rules less if you really understand grid layout).</li>
<li>The main challenge will be getting the SPE unit placed correctly, and since this disrupts the normal flow of the layout, writing the necessary rules to get everything else after that to go in its correct place again.</li>
</ul>
<p>Extra challenge:</p>
<ul>
<li>Notice that the gap between the academic years is twice as large as that within years (e.g. the vertical space between COMS10013 and COMS20007 is twice that between COMS10014 and COMS10013).</li>
<li>This can be achieved by leaving an empty grid row between the years, thus doubling the grid gap. That is, Year 1 lives in rows 1 and 2; row 3 is empty; Year 2 lives in rows 4 and 5 and so on - the empty row 3 has a height of 0 and no elements, but there are two gaps between rows 2 and 3, and 3 and 4, that separate the Year 1 from Year 2 units.</li>
<li>Alternatively, you could add extra margin (why not padding?) to the bottom of all TB2/TB4 units to achieve the same effect.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="responsive-layout-trees-exercise"><a class="header" href="#responsive-layout-trees-exercise">Responsive layout: trees exercise</a></h1>
<p>Download the <a href="cssgrid/../resources/trees.tar.gz">trees.tar.gz</a> file for this exercise and extract it (<code>tar -zxvf FILENAME</code>) to a folder, then open <code>trees.html</code> in your editor. Create an empty <code>trees.css</code> in the same folder and open that too.</p>
<p>The file contains images and English and Latin names of some trees at <a href="https://www.forestryengland.uk/westonbirt-the-national-arboretum">Westonbirt, the UK national arboretum</a>.</p>
<p>Your task is to write a stylesheet to create a responsive grid layout.</p>
<p>On media that is 600px or wider, the page should look like this:</p>
<p><img src="cssgrid/./trees-wide.png" alt="4 column layout above 600px" /></p>
<p>(The image for Lawson's Cypress is one single PNG like the others, there is nothing special to do here to fit in two images side by side.)</p>
<p><em>The small-leaved lime (Tilia Cordata) featured here is believed to be over 2000 years old, making it one of the oldest trees in Britain.</em></p>
<p>From 400px to 600px, the page should show all trees except the "featured" ones in two columns:</p>
<p><img src="cssgrid/./trees-medium.png" alt="2 column layout above 400px" /></p>
<p>And below 400px width, all trees should be shown in a single column layout, whether featured or not.</p>
<p>Each tree is defined in the HTML file with an element like this:</p>
<pre><code class="language-html">&lt;div class="card"&gt;
    &lt;img class="card-image" src="images/cedrus_atlantica.jpg" alt="Cedrus Atlantica"/&gt;
    &lt;span class="latin-name"&gt;Cedrus Atlantica&lt;/span&gt;
    &lt;span class="common-name"&gt;Atlas Cedar&lt;/span&gt;
&lt;/div&gt;
</code></pre>
<p>The two "featured" trees at the start also have class <code>featured</code> on their card element.</p>
<h2 id="exercise-1"><a class="header" href="#exercise-1">Exercise</a></h2>
<p>General non-grid-related CSS that you can just paste in:</p>
<pre><code class="language-css">body {
    font-family: "Open Sans", sans-serif;
    margin: 0;
}

header {
    background-color: #04443c;
    color: white;
    margin: 0;
    padding: 10px;
    padding-left: 50px;
}

.card {
    background-color: #167f5f;
    color: white;
}

.card-image {
    max-width: 100%;
    height: auto;
}

.card span.latin-name {
    display: block;
    font-style: italic;
    padding: 10px;
    padding-bottom: 0;
}

.card span.common-name {
    display: block;
    padding: 10px;
    padding-top: 5px;
    font-weight: bold;
}
</code></pre>
<ul>
<li>The grid should be horizontally centered if the screen is wider than the grid, by setting <code>margin: 0 auto</code> on the container.</li>
<li>The grid should be applied to the container div, with  a margin of 20px on top and bottom (this has to come after the horizontal centering), and a padding of 10px on left and right (this has to be padding, not margin, to avoid undoing the centering again).</li>
<li>Set a grid gap of 20px.</li>
<li>If the screen is at least 600px wide, then the container should have a maximum width of 960px and four equally wide columns. Featured trees should take up a 2x2 space on the grid, all other trees a 1x1 space.</li>
<li>Between 400px and 600px, the grid should only be two columns wide, trees still take up 2x2 space if featured and 1x1 otherwise.</li>
<li>Below 400px, make a grid with only one column, and all trees take up 1x1 space. Note that you do not need to do anything for this as this is the default - just make sure that your other grid rules such as making featured trees 2x2 only apply on larger screens.</li>
</ul>
<p>Test this out by making your browser window wider and narrower. You cannot normally make a chrome/edge window narrower than 400px, but there are two workarounds. With the F12 developer tools open, you can position them to the right of the window and then drag the divider to make the actual page width as narrow as you want, or you can switch to "mobile" mode (second icon in top left of developer tools, usually) and manually set a page size or select one from a dropdown list of common phone models.</p>
<div class="advanced container">
<header><span class="advanced-title"></span></header>
<div class="container-content">
<p>In practice, one would use a layout like this to make the individual grid elements clickable (such as news stories, or in this case links to a more detailed page about the tree).</p>
<p>One way to do this would be to use <code>&lt;a class="card" href="..."&gt;</code> elements instead of <code>&lt;div&gt;</code> ones, and set them manually to <code>display:block</code>. This has the advantage that the entire card, including the image, becomes clickable. An <code>&lt;a&gt;</code> tag can contain arbitrary content, not just text.</p>
</div>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript"><a class="header" href="#javascript">JavaScript</a></h1>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">JavaScript</a> is a programming language for creating dynamic web pages.</p>
<h2 id="videos-4"><a class="header" href="#videos-4">Videos</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Video</th><th style="text-align: right">Length</th><th>Slides</th></tr></thead><tbody>
<tr><td><a href="https://web.microsoftstream.com/video/2dc6a701-fa1a-40d8-89c2-27e99e976d7f">JavaScript: Basics</a></td><td style="text-align: right">24 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EfidO6rhwlhPs_AZSgBCH18BJ6eR1Zz4mIOpcbAiYxPpTQ?e=7KrHSL">Slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/0d40a41d-ed42-4441-8635-2cb8d452ed16">JS Objects (incl. JSON)</a></td><td style="text-align: right">5.21 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EYtHZ1I7R3BLgZdjTgvO_lQB5SMzb6CbIX1XIUBIYyPd7Q?e=QQUJY1">Slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/f9547854-f642-4b40-8800-7daab588c363">Object Oriented Programming</a></td><td style="text-align: right">9.40 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EXKvkOEwbmBNpw9Cmx8iiwUBkFJ1fv8t_qK8shkrVBsQtQ?e=hCMG3L">Slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/d5072390-853b-49a0-888c-9ed086b044df">Asynchronous JavaScript</a></td><td style="text-align: right">12 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/ERxtlsuDqslLtKOvIPCkxPwBWjsg85cJjoQIp6JdKeXUuA?e=Fm1PiJ">Slides</a></td></tr>
</tbody></table>
</div>
<p>Some example code can be found in the
<a href="https://github.com/cs-uob/COMSM0085/tree/master/code/javascript"><code>code/javascript</code></a>
folder of the repository.</p>
<h2 id="readings"><a class="header" href="#readings">Readings</a></h2>
<h3 id="essential"><a class="header" href="#essential">Essential</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/JSON">MDN: Working with JSON</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Client-side_web_APIs/Manipulating_documents">MDN: Manipulating documents</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/">MDN: Asynchronous JavaScript</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Client-side_web_APIs/Fetching_data">MDN: Fetching data from the server</a> (skip the section on <code>XMLHttpRequest</code>)</li>
</ul>
<h3 id="further"><a class="header" href="#further">Further</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">MDN: Arrow functions</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model">MDN: Document Object Model (DOM)</a> (see guides on the left)</li>
<li><a href="https://www.destroyallsoftware.com/talks/wat">Wat</a>, a famous <a href="https://en.wikipedia.org/wiki/Lightning_talk">lightning
talk</a> by Gary Bernhardt (2012).</li>
</ul>
<h3 id="advanced"><a class="header" href="#advanced">Advanced</a></h3>
<p>The following references go significantly beyond the curriculum.</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Inheritance_and_the_prototype_chain">MDN: Inheritance and the prototype chain</a>. This is a guide to the protoyping-style object-orientation of JavaScript.</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop">MDN: The event loop</a>. This explains the concurrency model of JavaScript, as well as the way asynchronous code and promises arehandled.</li>
<li><a href="https://sourceacademy.org/sicpjs/">Structure and Interpretation of Computer Programs, JS edition</a> (2022). This is a classic programming book that has been recently rewritten in JavaScript.</li>
<li>Boris Cherny, "<a href="https://bris.on.worldcat.org/oclc/1099253345">Programming TypeScript</a>" (2019). This is a book-length introduction to TypeScript, a typed extension to JavaScript which is also supported by React.</li>
</ul>
<h2 id="exercises-6"><a class="header" href="#exercises-6">Exercises</a></h2>
<ul>
<li><a href="js/./MyCoolApp.html">My Cool App</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-single-page-application-to-fetch-data-from-a-public-rest-api"><a class="header" href="#a-single-page-application-to-fetch-data-from-a-public-rest-api">A single-page application to fetch data from a public REST API</a></h1>
<p>In this lab, we are going to make a single-page web application to
find information out about movies using
JavaScript. You will learn how to use an API to fetch data and add it to the DOM of the HTML to view the results.</p>
<h2 id="setup"><a class="header" href="#setup">Setup:</a></h2>
<p>The basic of the application can be found in the GitHub repository. Three files exist in the folder; maintain the same structure as we discussed in the lecture. The script.js file will be partially completed, and it is required to fill in the remaining code for the application to work properly. The image folder contains the necessary images for the application to work.</p>
<p>First, download the folder with the files and folders. A way to do it is by using wget:</p>
<p>wget <a href="https://cs-uob.github.io/COMSM0085/exercises/part2/resources/movie-search.tar.gz">https://cs-uob.github.io/COMSM0085/exercises/part2/resources/movie-search.tar.gz</a></p>
<p>Then extract the contents using the command:</p>
<pre><code class="language-.sh"> tar -xzf movie-search.tar.gz
</code></pre>
<p>This command will create a folder that includes the files we need to build the application.</p>
<p>Check if Node.js is installed with</p>
<pre><code class="language-.sh">node -v
</code></pre>
<p>If not, install it in your Debian VM with:</p>
<pre><code class="language-.sh">sudo apt install node.js 
</code></pre>
<h3 id="what-is-an-api"><a class="header" href="#what-is-an-api">What is an API?</a></h3>
<p>An API is an interface that a programmer can call to access and
manipulate information.  For many websites these APIs are provided
as network services: you send <code>GET</code>, <code>PUSH</code> and <code>POST</code> requests as
normal and get data sent back in a suitable format (usually <code>JSON</code> or <code>XML</code>).  This lets us pulling data into an application without the need to store it locally.</p>
<p>APIs are important components of modern software development due to several reasons. An API provides a standardized way for different applications to access each other's data, even when they have different implementations. Additionally, APIs are utilized to enforce security measures in our development process. They ensure that only authorized users or applications can access certain data, enhancing the overall security of the system.</p>
<p>Feel free to make any changes to the CSS and HTML files by adding or
modifying elements, colors.</p>
<p>For this lab we will use a free API from <a href="https://www.themoviedb.org/">themoviedb.org</a>. This is a large database with movie data. To get an API key we must register to the site and create an account. Then from here we can request our API key.</p>
<p>To get an API key sign up at: <a href="https://developer.themoviedb.org/docs/getting-started">https://developer.themoviedb.org/docs/getting-started</a>.</p>
<p>Once the account is ready, <a href="https://www.themoviedb.org/settings/api/new/form?type=developer">create a new
app</a>:</p>
<ul>
<li><em>Type of Use</em>: Desktop Application</li>
<li><em>Application Name</em>: MyCoolApp</li>
<li><em>Application URL</em>: <code>http://localhost</code></li>
<li><em>Application Summary</em>: Learning JavaScripting and need an API to
test against</li>
</ul>
<p>Once the application is created it will give an <em>API Key</em> and an
<em>API Read Access Token</em> on the <a href="https://www.themoviedb.org/settings/api">API page</a>: <em>make a note of these!</em></p>
<p>This API is well-documented, and we can find all relevant information about how to make calls and use API methods in the following link: <a href="https://developer.themoviedb.org/reference/intro/getting-started">https://developer.themoviedb.org/reference/intro/getting-started</a></p>
<p>In the lab we will make HTTP <code>GET</code> requests to: <a href="https://api.themoviedb.org/3/discover/movie">https://api.themoviedb.org/3/discover/movie</a></p>
<p>We will create an app that fetches all the new and latest movies along with their details such as title, overview, and score. Instead of using a button, we will incorporate a search bar on our site to filter movies based on text input. The HTML code will not contain anything special, as we will populate the DOM with our JavaScript code.</p>
<h3 id="test-it-is-working"><a class="header" href="#test-it-is-working">Test it is working</a></h3>
<p>At this stage, before we add any external functionality, lets check
our website is working.  Bring up a webserver serving from your site's
root directory.  If you don't have a webserver handy, Python has a
simple one you can use for testing.  Bring it up with:</p>
<pre><code class="language-.sh">python -m http.server
</code></pre>
<p>This will create a server listening on <a href="http://localhost:8000">http://localhost:8000</a>.  Check
you can access it in a web browser; then leave it running in the
background.</p>
<p><strong>Hint</strong>: You don't need to open a new terminal to run something in
the background.  Hit <code>C-z</code> (control-z) to suspend a process.  Run <code>bg</code>
to send it to the background and let it continue running, and <code>fg</code> to
bring it back to the foreground.  See <code>man 1p jobs</code> or <code>help jobs</code> for
more information.</p>
<h2 id="javascript-1"><a class="header" href="#javascript-1">JavaScript</a></h2>
<p>We load our JavaScript from the <code>js/script.js</code> file, but unless you've
taken it from the GitHub repository you'll find your server is
returning <code>404 File not found</code>.  We need to create it.</p>
<p>Then, add your API key at the end, or use the one provided above by replacing the <code>XXX</code>.</p>
<p><em>(Tip: Refer to the example on this page: <a href="https://developer.themoviedb.org/reference/discover-movie">https://developer.themoviedb.org/reference/discover-movie</a>)</em></p>
<h3 id="code"><a class="header" href="#code">Code</a></h3>
<pre><code class="language-javascript">const API_URL =XXX
const IMG_PATH = 'https://image.tmdb.org/t/p/w500'
const SEARCH_API = 'https://api.themoviedb.org/3/search/movie?api_key=XXX&amp;query="'
</code></pre>
<p>The <code>const IMG_PATH</code> represents the <code>poster_path</code> (you can find more details in the API reference), and <code>SEARCH_API</code> concatenates a term from the search box into a query against the database. We aim for the most popular movies to be visible on our application page, replace the <code>XXX</code> with your API key.</p>
<p>Here, we declare the elements we want as constants to use them in our listener for the search box. To return an element object, we need to use a method. Fill in the missing method in the constants for each element.</p>
<pre><code class="language-javascript">const main =  XXX
const form = XXX
const search = XXX
</code></pre>
<p>This function below actually uses the API to fetch the movies we want.</p>
<pre><code class="language-javascript">function getMovies(url) {
    fetch(url)
        .then(response =&gt; response.json())
        .then(data =&gt; {
            showMovies(data.results);
        })
        .catch(error =&gt; {
            console.error('Error fetching movies:', error);
        });
}
</code></pre>
<p>For this lab, we want to improve our code by using the async/await method discussed in our lectures. We can find more theoretical details here: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch</a>. The Fetch API returns a promise, and we'll ensure our code waits for the API response before proceeding, using async/await.</p>
<p>Replace the preceding code block containing the function getMovies(url) with a block that utilizes the async/await method.</p>
<p>After enhancing our code with asynchronous programming, let's observe the disparities compared to synchronous programming. What are the benefits of asynchronous methods? Why are asynchronous methods generally preferred and considered advantageous?</p>
<p>To display results on the DOM, we'll use a function called showMovies(). We'll create a constant to extract the desired data from the movie object. Then, we'll construct a <div> for each movie element in the DOM using innerHTML.</p>
<pre><code class="language-javascript">function showMovies(movies) {
    main.innerHTML = ''

    movies.forEach((movie) =&gt; {
        const { title, poster_path, vote_average, overview } = movie

        const movieEl = document.createElement('div')
        movieEl.classList.add('movie')

        movieEl.innerHTML = `
            &lt;img src="${IMG_PATH + poster_path}" alt="${title}"&gt;
            &lt;div class="movie-info"&gt;
          &lt;h3&gt;${title}&lt;/h3&gt;
          &lt;span class="${getClassByRate(vote_average)}"&gt;${vote_average}&lt;/span&gt;
            &lt;/div&gt;
            &lt;div class="overview"&gt;
          &lt;h3&gt;Overview&lt;/h3&gt;
          ${overview}
        &lt;/div&gt;
        `
        main.appendChild(movieEl)
    })
}
</code></pre>
<p>The utility function getClassByRate changes the color of the vote to blue if it's equal 8 or higher, black if it's equal 5 or higher, and orange otherwise, indicating it's not recommended to see. Fill in the if-else statement appropriately:</p>
<pre><code class="language-javascript">function getClassByRate(vote) {
    

}
</code></pre>
<p>Here we create the listener that detects the search submit. We need a function here to handle our event object. Fill in the missing method by replacing the <code>XXX</code> with the appropriate one.</p>
<pre><code class="language-javascript">
// Get initial movies
getMovies(API_URL_HOME)

form.XXX('submit', (e) =&gt; {
    e.preventDefault()

    const searchTerm = search.value // we create a var with the search term

    if(searchTerm &amp;&amp; searchTerm !== '') { // and if the term exists 
        getMovies(SEARCH_API + searchTerm)

        search.value = ''
    } else {
        window.location.reload()
    }
})
</code></pre>
<p>Then, whatever we type in the search area will be appended to the search API to retrieve a response. Subsequently, the page reloads with the results. Feel free to search for any movie names in the search box and press enter! Resize the browser to inspect the flex effect, review these options in the css file.</p>
<p>When using an API key in JavaScript to access an API, we need to follow security best practices to protect the API key and prevent misuse.</p>
<p>Here's a guide on how to securely handle API keys in JavaScript:</p>
<p>In summary, this application serves to demonstrate how to utilize third-party REST APIs, how to use Fetch, and how to insert data into the DOM for viewing. When our API keys are hardcoded into JS code, they become easily accessible to anyone who views the source code. Therefore, we will use a technique to secure our API calls by using Environment Variables in Server-Side Code Only.</p>
<p>Without this technique, it could result in theft or misuse by attackers who may use the API key for malicious purposes, such as accessing sensitive data or performing unauthorized actions.</p>
<p>We make our JS code more secure by learning how to save our API key in a .env file and keep it secure and separate for the rest of the code on the server. To ensure that the sensitive API keys and URLs are only accesible on the server-side and not exposed to the clients we need to modify our script.js and create a server.js file. We will remove the direct usage of the API URLs and key and replace them with variables that will later inject from the server-side.</p>
<p>Fetching enviromental variables from the server allows more dynamic configuration and separates client-side code improving our code maintainability. The implementation also needs use of HTTPS to hide our environment variables transmitted over the network. We will explore this technique in a following lab.</p>
<p>Locally on our lab machine we need to install nodejs and dotenv package in the application folder:</p>
<pre><code class="language-linux">sudo apt install nodejs

sudo apt install npm

npm install dotenv
</code></pre>
<p><em>(Tip: More info can befound on this page: <a href="https://www.npmjs.com/package/dotenv">https://www.npmjs.com/package/dotenv</a>)</em></p>
<p>Follow the next steps:</p>
<ol>
<li>
<p>Create a new file in the project's directory and name it .env</p>
</li>
<li>
<p>Inside the .env file define the API key. For example use MOVIES_API_KEY. Then assign the value of the API key.</p>
</li>
</ol>
<p><em>(Tip: If we commit to a repository don't forget to add the .env to the .gitignore file to prevent the API key to be commited to the repository.)</em></p>
<ol start="3">
<li>Replace the API key inside the code by using an enviromental variable.</li>
</ol>
<p><em>(Tip: In some case we want to encrypt the .env to add more security to the implementation.)</em></p>
<p>This setup ensures that our API key is securely loaded from the .env file and is not hardcoded in our JavaScript code.</p>
<p>In the script.js remove direct usage of the API URL and replace them with variables that will later inject from the server. For example:</p>
<pre><code class="language-javascript">const API_URL_HOME = "{{API_URL_HOME}}";
const API_URL = "{{API_URL}}";
</code></pre>
<p>In the root folder create a server.js file to instruct how to use the API URLs and serve them to the client. The client-side JavaScript code cannot directly access the API URLs, we verify with the browser inspector tool.</p>
<p>In the server.js import the Node.js modules as variables: http, fs, path, dotenv.</p>
<p>Use the dotenv module to load variables from an <code>.env</code> file into a <code>process.env</code> object. With this object we ensure the store of our sensitive API key. In our code define a port for our server to listen on. FOr example:</p>
<pre><code class="language-javascript">const PORT = process.env.PORT || 3000;
</code></pre>
<p>Use a method to create an HTTP server that can take a callback function as an argument. This method should be invoked in every request to the server. Then determine the requested file path on the URL in the request with <code>fs.readFile()</code> This will read the requested file asynchronously. Then ensure the correct contect type for the HTTP response headers. Next step is to serve our static files such as the HTML, CSS, JS file and images. use the <code>fs.readFile()</code>.</p>
<p>Finally, start the server with the <code>server.listen()</code> method for example:</p>
<pre><code class="language-javascript">server.listen(PORT, () =&gt; {
  console.log(`Server is running on port ${PORT}`);
});
</code></pre>
<p>Now we have an HTTP server ready to serve static files and handle users request'. Don't forget to keep the project stracture as follows:</p>
<pre><code class="language-html">project/
├── index.html
├── css/
│   └── style.css
├── js/
│   └── script.js
├── img/
│   └── favicon.ico
│   └── logo_TMDB.svg
└── server.js
</code></pre>
<p>We access our application by going to our project directory and in the terminal run the following command:</p>
<pre><code class="language-linux">node server.js
</code></pre>
<p>If we are not getting any errors we can access then the application in the browser by navigating to <code>http://localhost:3000</code></p>
<h3 id="extras"><a class="header" href="#extras">Extras</a></h3>
<p>Now we've got a basic site up and running keep working on it... here
are some ideas of where to go next:</p>
<ul>
<li>Make it faster, make the code clearer!</li>
<li>Can we add a separate page for TV series?</li>
<li>Add more information about the movies to the DOM. The database
contains a lot more stuff!</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-scraping"><a class="header" href="#web-scraping">Web Scraping</a></h1>
<h2 id="videos-5"><a class="header" href="#videos-5">Videos</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Video</th><th style="text-align: right">Length</th><th>Slides</th></tr></thead><tbody>
<tr><td><a href="https://web.microsoftstream.com/video/9ceda4de-3749-4d9e-ad2c-3def7cd0c7d0">Crawling</a></td><td style="text-align: right">16 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/ESBfwTJqSNVDqEcdFdCaJLcBxKWpKIh63teq3unGb3zgwg?e=BDIm6Q">slides</a></td></tr>
<tr><td><a href="https://web.microsoftstream.com/video/4af3499f-3198-4d5e-8ff8-b0835a8721cd">BeautifulSoup</a></td><td style="text-align: right">10 minutes</td><td><a href="https://uob-my.sharepoint.com/:b:/g/personal/me17847_bristol_ac_uk/EU9FDAcFSLNHlp1qVuIa7NkBE6fsQ8xSWcaZpWyXlDRgOg?e=NqDC2z">slides</a></td></tr>
</tbody></table>
</div>
<h2 id="exercises-7"><a class="header" href="#exercises-7">Exercises</a></h2>
<ul>
<li><a href="scrape/./crawl.html">Crawling</a></li>
<li><a href="scrape/./soup.html">BeautifulSoup</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="crawling-the-web"><a class="header" href="#crawling-the-web">Crawling the Web</a></h1>
<p>So far in this unit we've had you use <code>wget</code> only for one of its simplest
use-cases: when you want to download a single file from the web. Consistent with
the Unix philosophy that tools should 'do one thing well', <code>wget</code> is capable of
a lot more than this.</p>
<p>To demonstrate this, we're going to have you first run a server to deploy a
website locally, and then test out various <code>wget</code> options by connecting to that
server via localhost. This of course doesn't mean that <code>wget</code> can only do these
things via localhost -- it's designed to work with real websites -- but we
decided that getting ~200 students to test out web-crawling on a particular live
website was probably not a great idea, so we're having each of you run your own.</p>
<h3 id="set-up-the-server"><a class="header" href="#set-up-the-server">Set up the server</a></h3>
<p>As with the HTTP exercises, it would be best to either carry out these steps directly on a lab machine
or on your own machine (optionally from the Debian Linux VM with ports forwarded). If you are using
a lab machine via SSH instead then you'll need to open a second SSH session <em>to the same lab machine</em>
in another terminal, to act as a client for the next parts of the exercise.
However, we'll periodically invite you to check things in your browser, which is
a lot simpler if you're not trying to use a remote machine.</p>
<p>First, download the <a href="scrape/../resources/cattax.tar.gz">webpages to be served by the webserver</a>.
If you like you can even do this using <code>wget</code>:</p>
<pre><code class="language-bash">wget https://cs-uob.github.io/COMSM0085/exercises/part2/resources/cattax.tar.gz
</code></pre>
<p>Then extract the contents of the tarball using <code>tar -xzf cattax.tar.gz</code> in the
folder you downloaded it to. This will create a folder <code>cattax</code> which contains some
webpages and resources.</p>
<p>Next, use the <code>darkhttpd</code> server from a previous week's exercises to
serve the content of the <code>cattax</code> folder on <code>localhost:8080</code>. <em>(Refer to the
HTTP week's exercise instructions if you have forgotten how to do this)</em>.</p>
<p>You can check that this is working in a browser (unless you are connecting via
SSH) by navigating to <code>localhost:8080/index.html</code> -- you should see a webpage
talking about <strong>Felidae</strong>. You'll need to leave this server running -- the
simplest way forward would be to open another terminal for the steps below.
<em>(Alternatively: use your shell expertise to figure out how to run the server in
the background without its output interfering with the rest of what you're going
to be doing in this terminal).</em></p>
<h3 id="single-page-download"><a class="header" href="#single-page-download">Single-page download</a></h3>
<p>To keep your filesystem tidy, we're going to work within a 'client' folder.
We'll be repeatedly downloading files and sometimes deleting them, and you'll
neither want lots of duplicated webpages littering your filesystem nor want to
run <code>rm *</code> in a directory that possibly contains files you don't want deleted.</p>
<p>Make sure you are in the parent directory that contains <code>cattax</code> (i.e., you can
type <code>ls</code> and see the directory <code>cattax</code> in the output) and <em>not inside</em>
<code>cattax</code> itself. Then create a directory and move into it:</p>
<pre><code class="language-bash">mkdir client
cd client
</code></pre>
<p>Now we'll start with the simple use of <code>wget</code> you have already become familiar
with:</p>
<pre><code>wget localhost:8080/index.html
</code></pre>
<p>This downloads the same <code>index.html</code> as is being served from <code>cattax</code> by
<code>darkhttpd</code>. However, if you open this downloaded file in your browser, you'll
see that there's a sense in which something missing -- <code>wget</code> has only
downloaded the specific HTML file you requested, and not any of the resources
that the page itself references, like the CSS file -- so the version you open in
your browser from your <code>client</code> directory won't look the same as the version
being served via localhost. This can be desirable default behaviour (we only
asked it to get that page, after all), but if we wanted to download a copy of a
webpage and later read that webpage's copy with the styles and images it was
originally created to contain, we'd need to get <code>wget</code> to also download these
resources.</p>
<p>One way to do this would be to manually identify each of the required resources
and download them one-by-one. But this is tedious, repetitive work -- highly
suited to automation -- and moreover, <code>wget</code> can save us the effort. Try the
following, and <strong>read the output</strong>.</p>
<pre><code>wget -p localhost:8080/index.html
</code></pre>
<p>Notice that this time <code>wget</code> downloaded multiple files. It also created a
directory named <code>localhost:8080</code> to store all the files in. This is helpful
organisation if you're ever using <code>wget</code> to download pages from multiple
different websites -- it stores them under directories named after the domain
you requested them from.</p>
<p>If you read the output carefully you'll notice that as well as the <code>index.html</code>
we requested directly, <code>wget</code> has also downloaded the <code>catstyle.css</code> file
referenced in that page, and another file called <code>robots.txt</code> that you didn't
ask for and which isn't mentioned in <code>index.html</code>. This 'robots' file is part of
a standard for responsible web crawling, and tells crawling tools which parts of
a website they are or aren't allowed to visit. When you use <code>wget</code> to crawl a
webpage or website it will check the site's <code>robots.txt</code> to understand which
resources it may not be allowed to download. You can read more about how these
files are written
<a href="https://developers.google.com/search/docs/crawling-indexing/robots/robots_txt">here</a>.</p>
<p>Open the <code>index.html</code> file from the new <code>localhost:8080</code> folder that was
created, and you should see that it looks just like the version you got in your
browser by navigating to the URI <code>localhost:8080/index.html</code>. <em>(There are some
cases where this wouldn't be true for a webpage -- wget can sometimes not be
permitted access to some resources required to display a page the same way as it
is shown in your browser).</em></p>
<h3 id="crawling-a-site"><a class="header" href="#crawling-a-site">Crawling a site</a></h3>
<p>The version of the webpage you downloaded using the previous command still has
one major flaw: the links on the page don't work. Or, rather, the links to the
'Felinae' and 'Pantherinae' pages are broken, because those links are made
relative to the webpage, and the corresponding files don't exist in the client's
folder.  The link to Wikipedia in the page footer <em>does</em> still work, because the
<code>href</code> attribute of that link is set to a full URI.</p>
<p>What do we do if we want to download more than one webpage from a site? Wget
supports something called 'recursive downloading'. Simply put, when used in this
manner it will follow all links internal to a site and download the resources
displayed at those links, storing a copy locally and creating a directory
structure if necessary. One version of this recursion is to use the <code>-r</code> (or
<code>--recursive</code>) option, which downloads all linked pages up to a certain maximum
depth. Try this out:</p>
<pre><code>wget -r -l 1 localhost:8080/index.html
</code></pre>
<p>This downloads recursively with the 'level' (maximum depth of recursion) set to
1 level of recursion. You should see that both the requested <code>index.html</code> and
the two pages linked from that resource have been downloaded, along with
<code>robots.txt</code>. Notice as well that the Wikipedia page has not been downloaded --
it's not hosted at <code>localhost:8080</code>, so <code>wget</code> ignores it, and the link will
work from the downloaded page anyway.  Our two newly-downloaded pages, however,
will contain dead links to other pages, because we limited the depth of
recursion to just one hop.  If we increase this:</p>
<pre><code>wget -r -l 2 localhost:8080/index.html
</code></pre>
<p>You'll see that a <em>lot</em> more files get downloaded. These are only very small,
simple web-pages, without many links (contrast, for example, any given Wikipedia
page). Very short recursion depths can capture an awful lot of a domain, and if
you ever tell <code>wget</code> to crawl links without caring about which domain they
belong to, this becomes explosively worse (<code>-l 2</code> in such a case for our
<code>index.html</code> would involve
downloading everything linked from the Wikipedia page referenced in the footer
-- several hundred resources).  In the case of our cattax website, however,
there are still a few pages that are more than 2 steps away from the index page.
Let's start afresh:</p>
<pre><code>rm -r localhost:8080
wget -m localhost:8080/index.html
</code></pre>
<p>The <code>-m</code> flag is designed to provide some sensible defaults for 'mirroring' an
entire website (something you might do if you wanted to keep a copy of it for
offline browsing, or for providing a public backup of a valuable resource). It
sets the recursion level to infinite and checks timestamps before downloading
files, as well as setting a few more configuration settings. For many cases
where you might want to download an entire website, this is the flag you would use --
perhaps also with a polite <code>-w 1</code>, which sets a 1-second delay between requests,
to avoid over-burdening the server if the website is large.</p>
<h2 id="further-exercises"><a class="header" href="#further-exercises">Further Exercises</a></h2>
<ol>
<li>Read <code>man wget</code> to understand what the <code>-i</code> <code>--force-html</code> and <code>--spider</code>
options do. Download a copy of this webpage (the one you are currently
reading) and use <code>wget</code> to test all the links on the page. Are there any broken
links?</li>
<li>Tell <code>wget</code> to use a different user agent string in a request to your server running
on localhost. Check what the request looks like to your server.</li>
<li>How would <code>wget -r -l 1 http://example.com</code> differ from <code>wget -p http://example.com</code>? <em>(Hint: think about external resources)</em>.</li>
<li>Look for 'Recursive Accept/Reject options' in the <code>wget</code> manpage. How would
you get <code>wget</code> to crawl pages from multiple different domains?</li>
<li>Look up what <code>-nc</code> does. What is clobbering, and why would or wouldn't you
want to do it?</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="beautifulsoup"><a class="header" href="#beautifulsoup">BeautifulSoup</a></h1>
<p>Previously in this unit we have taught you how to construct webpages, including how
to construct webpages so that they present structured information (e.g., the
contents of a database). The presumption has generally been that you are
designing webpages for (usually visual) consumption by a human using a standard
web browser, or at most writing Javascript functions that will help a human use
a webpage in particular way.</p>
<p>However, there are situations where you may need to write code that interacts
with webpages in an automated fashion -- perhaps to extract some data from webpages
that isn't available in a more machine-friendly format. This <em>scraping</em> of
webpages is a valuable (if sometimes maliciously applied) skill that can be
useful to many kinds of software engineers and data scientists. This exercise
talks you through some applications of one of the most common frameworks, a
Python library called BeautifulSoup.</p>
<h2 id="setup-1"><a class="header" href="#setup-1">Setup</a></h2>
<p>First, you want to install the BeautifulSoup library, which you can achieve with
<code>sudo apt install python3-bs4</code>. Python does have its own package manager, <code>pip</code>,
but it would get in the way of our system-wide package management to use it here.</p>
<p>You can test that Python is working by just typing <code>python3</code> at the command line
-- it should launch the interactive interpreter, which will prompt you for
Python code with <code>&gt;&gt;&gt;</code>. Type <code>from bs4 import BeautifulSoup</code>. If this completes
then you've successfully imported the library.</p>
<h2 id="interacting-with-soup"><a class="header" href="#interacting-with-soup">Interacting with Soup</a></h2>
<p>Next, enter something like the following:</p>
<pre><code class="language-python">file = "cattax/index.html"
soup = BeautifulSoup(open(file, 'r'))
</code></pre>
<p><em>(You may need to change the 'file' line to reflect where the <code>cattax/index.html</code>
file really is relative to where you launched <code>python3</code>. Also, if you close the
interpreter at any point remember you'll need to re-run the <code>import</code> line above
to get the library).</em></p>
<p>You now have a 'soup' object, which is a Python object that has various methods
for interacting with HTML (and XML) documents and accessing their contents. To
start with, just type <code>soup</code> in your interpreter. Python will print out the
basic textual representation of the object, which is just the source of the
<code>index.html</code> page. Next, let's attempt one of the commonest use-cases for scraping.</p>
<pre><code class="language-python">soup.get_text()
</code></pre>
<p>You should see a string containing the textual content of the webpage. If you
call <code>print</code> on the result, you should see that the text has been laid out in a
fair approximation of how the visible text would appear on a webpage.</p>
<pre><code class="language-python">text = soup.get_text()
print(text)
</code></pre>
<p>Getting the visible text out of a page is a common requirement if, e.g., you
were going to use the webpage as input to an NLP system. You can also access
non-visible portions of the page -- <code>soup.title</code> will give you the title element
of the webpage, and <code>soup.title.text</code> will get you the textual content within
the title element. Note the difference: <code>soup.title</code> is a BeautifulSoup element
(of type <code>Tag</code>), and has methods associated with being a tag; <code>soup.title.text</code>
is just a string, and only has methods that apply to strings.</p>
<p>As HTML documents are structured, you can interact with them in a structured
manner. <code>soup.head</code> will get you a soup object reflecting the 'head' part of
the HTML structure, and <code>soup.head.findChildren()</code> will return a list containing
all of the 'children' elements inside the head. By knowing the structure of the
document you can thus navigate to certain elements programmatically. This
doesn't just relate to the tags, either: you can also access the value of
attributes. <code>soup.head.meta['charset']</code> would access the <code>charset</code> attribute of
the meta tag in the head of the document.</p>
<h3 id="exercises-8"><a class="header" href="#exercises-8">Exercises</a></h3>
<ol>
<li>Take a look at some other examples from <a href="https://beautiful-soup-4.readthedocs.io/en/latest/#navigating-the-tree">the BeautifulSoup documentation</a>, in particular regarding the use of the <code>.find_all()</code> method.</li>
<li>Use your interpreter to access a list of all the <code>&lt;strong&gt;</code> elements in the
webpage, and figure out how to print out just the text contained within them.</li>
<li>How would you use <code>.find_all()</code> to find all <code>&lt;div&gt;</code> elements with a
particular class value (e.g., 'container')? Would your method work if the div
had multiple classes?</li>
</ol>
<h2 id="a-scraping-script"><a class="header" href="#a-scraping-script">A Scraping Script</a></h2>
<p>Download <a href="scrape/../resources/scrape.py">this python script</a> to the directory that
contains your <code>cattax</code> folder (<em>not</em> into <code>cattax</code> itself). On the command line,
you should be able to run this script with <code>python3 scrape.py</code>. You'll see that
it prints out a series of lines related to all the files in <code>cattax</code>.</p>
<p>Open <code>scrape.py</code> in an editor and inspect what it is doing. The script imports
two libraries, one is BeautifulSoup and the other is <code>os</code>, which allows the
script to use certain operating system functions. <code>os.listdir</code> is then used to list the
contents of our <code>cattax</code> directory and iterate over them. We filter the
filenames by checking to see which of them end with the string 'html', and if
they do then we open the file and parse it into a BeautifulSoup object. Then, we
print out text from certain elements, separated by a ':'. Understand how this
works, asking a TA or lecturer for help if you aren't sure.</p>
<h3 id="exercises-9"><a class="header" href="#exercises-9">Exercises</a></h3>
<ol>
<li>Modify <code>scrape.py</code> so that it <em>also</em> prints out the contents of the 'info'
paragraph in each page (this can be a second print statement). Run the script
again to test that it works.</li>
<li>Currently the script prints something for <em>every</em> page. Modify it so it would
only print something out for the leaf nodes -- those pages that don't have a
'container' element of their own.</li>
<li>Printing things out can be useful, but often we want to store values we
scrape for later programmatic work. Rather than printing out information,
create and update a <a href="https://realpython.com/python-dicts/">Python dict</a> for all
leaf nodes where the dictionary keys are the titles of a page and the values are
the corresponding content of the 'info' box. <em>Run your script with <code>python3 -i scrape.py</code> and it will execute your script and then place you in an interactive
session immediately following your script's execution. You can then check that
the dictionary's contents are what you expect by interacting with the dict
object in your interpreter.</em></li>
</ol>
<h2 id="when-to-scrape"><a class="header" href="#when-to-scrape">When to scrape</a></h2>
<p>As we discuss in this week's lectures, scraping webpages can come with some
risks, depending upon how you go about it and what you do with the results.
Guidelines you should follow include:</p>
<ul>
<li>Always respect the <a href="https://developers.google.com/search/docs/crawling-indexing/robots/robots_txt">robots.txt</a> presented by a site. Resources denied to crawlers may be protected for a legal or ethical reason.</li>
<li>Always look for an API first. If a site will provide you with a JSON endpoint
to query for the structured data you want, it is both easier and more polite
to use that API instead of scraping the same data from webpages designed for
human consumption.</li>
<li>Be very careful about any scraping behind an authenticated log-in, such as
from a logged-in social media account. Think about the privacy expectations
people have about the content you are collecting, both in legal and ethical
terms. If you post publicly something that was intended only for a limited
audience, you could be betraying a confidence, and might even face legal
repercussions.</li>
<li>Generally beware that being able to access and read information from the web
does not mean you are permitted to republish it, even in a modified form.</li>
</ul>
<h2 id="further-reading"><a class="header" href="#further-reading">Further reading</a></h2>
<p>You may have noticed that we downloaded our webpages with <code>wget</code> in the previous
exercise, and then dealt with their content using Python in this one. If you
were writing a Python tool that was meant to do something specific with the
content of a webpage, then you would often want to avoid using a second tool,
and make web requests directly from your program.
The Python library that is most often recommended for requesting web resources
is the <a href="https://docs.python-requests.org/en/latest/">Requests library</a>, and
getting familiar with it would be useful both if you wanted to access web pages
programmatically and if you need to interact with a website's API.</p>
<p>We've also been dealing with the content of <em>static</em> websites, without the dynamic
content like that you learned about in the Javascript exercises. Scraping
dynamic sites gets trickier, as your scraper needs to have a browser-like
context to execute Javascript within, and often might need to pretend to
interact with the page. Systems like <a href="https://www.selenium.dev/documentation/">Selenium</a>
are designed for cases like this.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="practical-encryption"><a class="header" href="#practical-encryption">Practical Encryption</a></h1>
<h2 id="videos-6"><a class="header" href="#videos-6">Videos</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Video</th><th style="text-align: right">Length</th><th>Slides</th></tr></thead><tbody>
</tbody></table>
</div>
<h2 id="exercises-10"><a class="header" href="#exercises-10">Exercises</a></h2>
<ul>
<li><a href="encryption/./openssl.html">OpenSSL</a></li>
<li><a href="encryption/./pgp.html">PGP</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-to-openssl-a-hands-on-lab-using-openssl-and-encryption"><a class="header" href="#introduction-to-openssl-a-hands-on-lab-using-openssl-and-encryption">Introduction to OpenSSL: A Hands-On Lab using OpenSSL and encryption</a></h1>
<p>OpenSSL is a widely used open-source software library that provides cryptographic functions and protocols to secure communications over computer networks. In this lab, we will gain hands-on experience with OpenSSL by performing cryptographic operations. The goal of this lab is to learn how to generate cryptographic keys, create digital certificates, and perform encryption and decryption operations.</p>
<h1 id="objectives"><a class="header" href="#objectives">Objectives:</a></h1>
<ul>
<li>Understand the purpose and role of SSL Certificate Authorities in web security.</li>
<li>Create a root Certificate Authority (CA) for local development.</li>
<li>Generate SSL certificates for localhost domains.</li>
<li>Configure web servers to use the self-signed SSL certificates for HTTPS.</li>
<li>Test the secure communication with HTTPS-enabled web servers.</li>
</ul>
<h3 id="first-we-install-the-openssl-tool"><a class="header" href="#first-we-install-the-openssl-tool">First we install the OpenSSL tool</a></h3>
<p>Use your VM to install <code>openssl</code> with the appropriate command. On Debian that is:</p>
<pre><code class="language-.sh">$ sudo apt install openssl 
</code></pre>
<p>Alternatively, you could build from the source <a href="https://www.openssl.org/source/">https://www.openssl.org/source/</a> after obtaining and extracting it:</p>
<pre><code class="language-.sh">$ ./config
$ make
$ make test # This step is optional.
$ sudo make install
</code></pre>
<p>Remember that you can add the <code>apt install</code> line to your Vagrantfile to use OpenSSL on Vagrant.</p>
<h1 id="use-openssl-to-encrypt-files-with-symmetric-encryption"><a class="header" href="#use-openssl-to-encrypt-files-with-symmetric-encryption">Use OpenSSL to encrypt files with symmetric encryption</a></h1>
<p>Create a text file called <code>mytext.txt</code> and write a message you want to send inside it.
Then, encrypt this file with a symmetric AES 256 key using OpenSSL:</p>
<pre><code class="language-bash"> openssl aes256 -in mytext.txt -out mytext.enc
</code></pre>
<p>You'll be asked for a passphrase to create the key. The output will be named <code>mytext.enc</code>. Be sure not to forget your passphrase.</p>
<h4 id="what-is-the-difference-between-your-unencrypted-file-and-the-encrypted-one-try-and-read-an-ecrypted-file"><a class="header" href="#what-is-the-difference-between-your-unencrypted-file-and-the-encrypted-one-try-and-read-an-ecrypted-file">What is the difference between your unencrypted file and the encrypted one? Try and read an ecrypted file.</a></h4>
<p>Alternatively, you can encode the encrypted file with <code>base64</code>. This option creates a file with ASCII characters instead of a pure binary stream, making it suitable for sending via email. To do this, encrypt again specifying base64 instead of AES 256, and also passing the <code>-a</code> flag.</p>
<h4 id="is-the-file-size-larger-than-before-if-so-why"><a class="header" href="#is-the-file-size-larger-than-before-if-so-why">Is the file size larger than before? If so, why?</a></h4>
<p>Now, you can send your encrypted sensitive information to the recipient.</p>
<h2 id="how-to-decrypt-using-openssl"><a class="header" href="#how-to-decrypt-using-openssl">How to decrypt using OpenSSL</a></h2>
<p>Use email or another method to swap encrypted files with someone. Utilize the <code>-d</code> parameter to decrypt the file, whether it's a binary stream or consists only of ASCII characters. You'll need to use the same passphrase for this as was used to encrypt the file.</p>
<h4 id="once-decrypted-can-you-read-the-correct-message"><a class="header" href="#once-decrypted-can-you-read-the-correct-message">Once decrypted, can you read the correct message?</a></h4>
<h1 id="use-openssl-to-encrypt-files-with-asymmetric-encryption"><a class="header" href="#use-openssl-to-encrypt-files-with-asymmetric-encryption">Use OpenSSL to encrypt files with asymmetric encryption</a></h1>
<p>Asymmetric encryption uses two sets of keys, called a key pair. A public key that can be freely distributed with the entity you want to communicate with, and a private key that is never shared.</p>
<h2 id="generate-key-pairs"><a class="header" href="#generate-key-pairs">Generate key pairs</a></h2>
<p>Using the <code>openssl</code> man pages, figure out how to use <code>genrsa</code> to generate a 1024-bit public-private key pair.</p>
<h2 id="distribute-the-public-key"><a class="header" href="#distribute-the-public-key">Distribute the public key</a></h2>
<p>The public key is meant to be shared with others. Extract your public key with the OpenSSL tool into a <code>.pem</code> file using the <code>-pubout</code> parameter.</p>
<h2 id="exchange-your-public-keys"><a class="header" href="#exchange-your-public-keys">Exchange your public keys</a></h2>
<p>Exchange public keys with someoone else. Next, create an encrypted message using the OpenSSL <code>-encrypt</code> command. You will need the following to formulate the command:</p>
<ul>
<li>Name of the file</li>
<li>Other's person public key to encrypt</li>
<li>The name of the output file</li>
</ul>
<h4 id="try-and-view-the-file-what-is-the-format"><a class="header" href="#try-and-view-the-file-what-is-the-format">Try and view the file, what is the format?</a></h4>
<p>Send the file to the other party using your preferred method. The other person can decrypt the file and read the message using the private key and the parameter <code>-decrypt</code>. The recipient can write a response, encrypt it with your public key and send it back.</p>
<h2 id="why-do-we-need-https"><a class="header" href="#why-do-we-need-https">Why do we need HTTPS?</a></h2>
<p>Websites with HTTPS provide assurance to customers that their connections are secure. HTTPS, or Hypertext Transfer Protocol Secure, is a protected version of HTTP, the protocol used for data transmission between your browser and the website you're accessing. Prioritizing the safeguarding of users' privacy and data security is crucial for instilling trust in people connected to the web services we develop online</p>
<h2 id="why-will-we-use-https-locally"><a class="header" href="#why-will-we-use-https-locally">Why will we use HTTPS locally?</a></h2>
<p>We need to create a development environment that closely resembles production. This practice helps to avoid future issues when deploying your web apps or websites online.</p>
<h1 id="configure-and-utilize-nginx-with-https-for-creating-a-localhost-web-app-and-sign-a-certificate-request-with-openssl"><a class="header" href="#configure-and-utilize-nginx-with-https-for-creating-a-localhost-web-app-and-sign-a-certificate-request-with-openssl">Configure and utilize Nginx with HTTPS for creating a localhost web app and sign a certificate request with OpenSSL.</a></h1>
<p>A certificate signing request (CSR) consists of three entities: the public key, the system that triggers the request, and the signature of the request. The private key will be used to encrypt the certificate. We will use OpenSSL for that.</p>
<p>To create a private key with OpenSSL, we first create a directory and generate the key inside it:</p>
<pre><code class="language-.sh">$ mkdir ~/store-csr
</code></pre>
<p>Then, we generate the RSA private key (keep note of the passphrase). Use OpenSSL with the <code>genrsa</code> command and the <code>-aes256 parameter</code> for a private key with size 2048. Next, generate a root certificate with OpenSSL using the <code>req</code> command and parameters <code>-x509</code> for a digital signature and <code>-sha256</code> for a hash function. Finally, make it valid for 30 days.</p>
<p>Then, we will make a request for the server we will use later, and we want to authenticate, for example:</p>
<pre><code class="language-.sh">$ openssl genrsa -out cert.key 2048
</code></pre>
<p>As we can see from the output, we generated an RSA private key of 2048 bits. The <code>genrsa</code> command is used to generate RSA private key files, with the default value being 512 bits. You can specify different key sizes. Investigate the command options with <code>-help</code>.</p>
<p>Now, with the private key, we will create the CSR using the OpenSSL tool. Fill out the fields in a similar way as above, without leaving any value blank. We use the private key to create a certificate signing request as follows:</p>
<pre><code class="language-.sh">$ openssl req -new -key cert.key -out cert.csr
</code></pre>
<h2 id="create-the-configuration-file"><a class="header" href="#create-the-configuration-file">Create the Configuration File</a></h2>
<p>We create a configuration file named <code>openssl.cnf</code> in the current folder using any text editor of your choice:</p>
<pre><code class="language-conf">[#]Extensions to add to a certificate request

basicConstraints       = CA:FALSE

authorityKeyIdentifier = keyid:always, issuer:always

keyUsage               = nonRepudiation, digitalSignature, keyEncipherment, dataEncipherment

subjectAltName         = @alt_names

[ alt_names ]

DNS.1 = your hostname
</code></pre>
<hr />
<p>Sign the certificate request and enter the passphrase. Verify the correctness of the certificate as follows:</p>
<pre><code class="language-bash">$ ~/store-csr$ openssl verify -CAfile rootCert.pem -verify_hostname your hostname cert.crt
</code></pre>
<p>Add the certificate to the browser to avoid receiving warnings about untrusted certificates. For the Mozilla browser, follow these steps:</p>
<ul>
<li>Go to Preferences -&gt; Privacy -&gt; View Certificates.</li>
<li>Import the rootCert.pem file.</li>
<li>Click "Next" and then select "Trust this CA to identify websites."</li>
<li>These steps will ensure that the root certificate is trusted by the browser for identifying websites.</li>
</ul>
<p><em>Tip: if you want to name or re-name your machine use: <code>sudo hostnamectl set-hostname [new-hostname]</code> and check with <code>hostnamectl</code></em></p>
<p>Move the certificate and key into the folders:</p>
<pre><code class="language-bash">$ ~/store-csr$ sudo cp cert.crt /etc/ssl/certs/
$ sudo cp cert.key /etc/ssl/private/
</code></pre>
<h2 id="nginx-configuration"><a class="header" href="#nginx-configuration">Nginx Configuration</a></h2>
<p>Install Nginx:</p>
<pre><code class="language-bash">$ sudo apt install nginx
</code></pre>
<p>Create a configuration file inside <code>/etc/nginx/sites-available</code>. For example, create a file <code>yourhostname.conf</code>:</p>
<pre><code class="language-bash">/etc/nginx/sites-available$ sudo nano myhostname.conf
</code></pre>
<pre><code class="language-conf">server {
    client_max_body_size 100M;
    server_name yourhostname;
    listen 443 ssl;
    ssl_certificate /etc/ssl/certs/cert.crt;
    ssl_certificate_key /etc/ssl/private/cert.key;

    location / {
        proxy_pass http://yourhostname:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-Proto https;
        proxy_read_timeout 60;
        proxy_connect_timeout 60;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
</code></pre>
<p>Edit your <code>bash /etc/hosts </code> file and add the line <code>bash 127.0.0.1 “yourhostname” </code> using <code>sudo</code>.</p>
<p>Restart the server:</p>
<pre><code class="language-bash">sudo systemctl restart nginx.service
</code></pre>
<p><em>Tip: If you encounter any error check with <code>sudo tail -f /var/log/nginx/error.log</code></em></p>
<p>Create a symbolic link between the sites from nginx and your configuration file:</p>
<pre><code class="language-bash">sudo ln -s /etc/nginx/sites-available/yourhostname.conf /etc/nginx/sites-enabled/
</code></pre>
<p>If everything is configured correctly, you should have access to your local website with your self-signed certificate, i.e., <a href="https://my-hostname/">https://my-hostname/</a>. This is a good way to test your web application locally before publishing it. Now you have created a local development environment to test your apps using HTTPS.</p>
<h1 id="how-to-use-openssl-to-test-an-ssl-connections"><a class="header" href="#how-to-use-openssl-to-test-an-ssl-connections">How to use OpenSSL to test an SSL connections</a></h1>
<p>The OpenSSL tool includes many utilities. We can use one of them to verify a secure connection to a server. To do so, we will use the <code>s_client</code> utility to establish client-to-server communication. Therefore, we can determine whether a port is open, if the server is configured to support SSL, and when the certificate expires.</p>
<p>In the terminal, use <code>s_client</code> against a webserver with HTTPS.</p>
<h4 id="what-are-the-differences-compared-to-other-tools-such-as-netcat-or-telnet"><a class="header" href="#what-are-the-differences-compared-to-other-tools-such-as-netcat-or-telnet">What are the differences compared to other tools such as netcat or telnet?</a></h4>
<p>Try running the command again with the <code>-crlf</code> and <code>-brief flags</code>. What is the difference?"</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-to-pgp-encryption"><a class="header" href="#introduction-to-pgp-encryption">Introduction to PGP encryption</a></h1>
<p>This hands-on lab session aims to introduce you to PGP (Pretty Good Privacy), widely used encryption software for securing email communication and data files. Through practical exercises, you will learn how to generate PGP key pairs, encrypt and decrypt messages, sign and verify files, and exchange encrypted emails. This lab will provide all the essential skills for using PGP for secure communication and data protection.</p>
<h2 id="objectives-1"><a class="header" href="#objectives-1">Objectives:</a></h2>
<ul>
<li>Understand the principles of PGP encryption and digital signatures.</li>
<li>Generate PGP key pairs for encryption and signing.</li>
<li>Encrypt and decrypt messages using PGP.</li>
<li>Sign and verify files using PGP digital signatures.</li>
<li>Exchange encrypted messages with classmates.</li>
</ul>
<h2 id="generating-pgp-key-pairs-to-begin-gpg-tool-to-encrypt-all-the-communication-we-want"><a class="header" href="#generating-pgp-key-pairs-to-begin-gpg-tool-to-encrypt-all-the-communication-we-want">Generating PGP Key Pairs to begin GPG tool to encrypt all the communication we want.</a></h2>
<p>Use your VM to install <code>gnupg</code> with the appropriate command (if not already installed). On Debian that is:</p>
<pre><code class="language-bash">sudo apt-get install gnupg
</code></pre>
<p>First, create a keypair with the command:</p>
<pre><code class="language-bash">gpg --generate-key
</code></pre>
<p><em>Tip: Don’t forget the passphrase, use a strong one!</em></p>
<p>You can send your public key by exporting it through the GPG application:</p>
<pre><code class="language-bash">$ gpg --output ~/mypub.key --armor --export youremail@mail.com
</code></pre>
<p>You can send the key by email or any method of your choice.</p>
<h2 id="how-to-import-locally-foreign-public-keys"><a class="header" href="#how-to-import-locally-foreign-public-keys">How to import locally foreign public keys</a></h2>
<p>We need to accept other users' public keys if we want to communicate with them. When you receive others' public keys, import them using the <code>import</code> parameter.</p>
<p><em>Tip: There are other options to share your public key, such as using a public key server. Here's how to verify other keys.</em></p>
<p>While it's generally safe to distribute your public keys, caution should be exercised when obtaining keys from other users. Therefore, it's crucial to verify the identity of others before importing their keys and initiating communication. A quick method to accomplish this is by comparing the fingerprints derived from those keys. Use the following command:</p>
<pre><code class="language-bash">$ gpg --fingerprint youremail@mail.com
</code></pre>
<p>This will result in a more concise string of numbers, making it easier to compare. We can then verify this string either with the individual themselves or with another party who has access to the person in question.</p>
<h2 id="now-sign-the-keys"><a class="header" href="#now-sign-the-keys">Now sign the keys</a></h2>
<p>By signing each other's keys, we essentially indicate trust in the keys we possess and confirm the identity of the individual associated with that key.</p>
<pre><code class="language-bash">$ gpg --sign-key youremail@mail.com
</code></pre>
<p>To ensure that the person whose key you're signing benefits from your trusted relationship, send them back the signed key. You can accomplish this by typing:</p>
<pre><code class="language-bash">$ gpg --output ~/signed.key --export --armor youremail@mail.com
</code></pre>
<p>Upon receiving this newly signed key, they can import it, incorporating the signing information you've generated into their GPG database. They can achieve this by using the <code>import</code> parameter.</p>
<p>Now that you have established a secure channel to communicate with trusted ends, you can send and receive encrypted messages with each other!</p>
<p>After sharing your key with the other party, you can now send and receive encrypted messages. You can encrypt your messages with the following command:</p>
<pre><code class="language-bash">$ gpg --encrypt --sign --armor -r other_person@mail.com file_name
</code></pre>
<p>This command encrypts the message and signs it with your private key to ensure that the message originates from you. The output will be an encrypted file with the extension <code>.asc</code>. You can use the <code>cat</code> command to view the file.</p>
<p>Keep in mind that this message will be encrypted using the recipient's public key, making it unreadable to you (Unless you somehow obtain the recipient's private key!).</p>
<p><em>Tip: You can modify the command above to generate a message only you can read, using your private key. Think about how.</em></p>
<h2 id="decrypt-received-messages"><a class="header" href="#decrypt-received-messages">Decrypt received messages</a></h2>
<p>Upon message receipt, you would be able to read with the <code>gpg</code> command and the <code>decrypt</code> parameter.</p>
<p><em>Tip: In case you have a raw stream text message, paste the message after typing <code>gpg</code> with no arguments. Then press <code>CTRL+D</code> to end the message.</em></p>
<p>If you've completed all the above steps correctly, you can now communicate securely with different individuals. You can send your public key to multiple recipients and import multiple keys as well. This is an essential step to keep your messages private and protect your sensitive information from eavesdropping attacks.</p>
<h2 id="import-other-peoples-public-keys-from-a-public-key-server"><a class="header" href="#import-other-peoples-public-keys-from-a-public-key-server">Import other people's public keys from a public key server</a></h2>
<p>An alternative method to share your GPG keys is through a public keyserver. Anyone can upload a key to a public server, making it accessible to others who may need to communicate securely with you.</p>
<p>Export your public key using:</p>
<pre><code class="language-bash">$ gpg --armor --export email
</code></pre>
<p>Send your public key to a public server using the <code>--send-key</code> parameter. By default, your key is sent to <a href="https://keys.openpgp.org/">https://keys.openpgp.org/</a>, or you can specify a different key server using the <code>--keyserver</code> option.</p>
<p>Before importing a user's key, verify its validity with the command <code>gpg --list-sigs user_id</code> where the <code>user_id</code> is for example the email address you want to communicate with. To find a key on a public keyserver, use the <code>--search</code> parameter.</p>
<p>Import the key you want with the <code>--import</code> parameter. You can once again verify the sender's identity using the  <code>--fingerprint</code> parameter and checking its validity via a second channel. Then, similarly, sign the key obtained from the public key server.</p>
<h3 id="here-you-can-find-some-key-ids-of-people-you-may-certainly-know"><a class="header" href="#here-you-can-find-some-key-ids-of-people-you-may-certainly-know">Here you can find some key IDs of people you may certainly know:</a></h3>
<ul>
<li><strong>413109AF27CBFBF9</strong>,</li>
<li><strong>9A88F479F6D1BBBA</strong>,</li>
<li><strong>1C29680110FA7E87</strong></li>
</ul>
<p>These keys are on the <a href="http://keyserver.ubuntu.com//">http://keyserver.ubuntu.com//</a> public keyserver.</p>
<ul>
<li>Use the <code>gpg</code> command with the <code>--search</code> parameter to find out, for each key, the associated email address or User ID (username).</li>
<li>Use the <code>gpg</code> command with the <code>--recv-keys</code> parameter if you decide to import a key into your keyring.</li>
<li>Use the <code>gpg</code> command with the <code>--fingerprint</code> option to verify the authenticity of the keys.</li>
<li>Now, can you try searching based on the email addresses?</li>
<li>Can you find Joseph's old expired key?</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
